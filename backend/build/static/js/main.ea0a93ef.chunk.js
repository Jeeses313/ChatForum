(this.webpackJsonpchatforum=this.webpackJsonpchatforum||[]).push([[0],{137:function(e,t,n){e.exports=n(161)},151:function(e,t,n){},161:function(e,t,n){"use strict";n.r(t);var a=n(24),r=n(0),c=n.n(r),o=n(23),i=n.n(o),l=n(59),u=n(5),s=n(171),m=n(165),d=n(120),b=n(15),f=n(11);function g(){var e=Object(b.a)(["\n    subscription {\n        userCreated {\n            username\n            imageUrl\n            admin\n            joinDate\n        }\n    }\n"]);return g=function(){return e},e}function p(){var e=Object(b.a)(["\nmutation deleteUserProfilePic {\n    deleteUserProfilePic {\n        username\n        imageUrl\n    }\n}\n"]);return p=function(){return e},e}function h(){var e=Object(b.a)(["\nmutation setUserProfilePic($imageUrl: String!) {\n    setUserProfilePic(imageUrl: $imageUrl)  {\n        username\n        imageUrl\n    }\n}\n"]);return h=function(){return e},e}function E(){var e=Object(b.a)(["\n    query {\n        users {\n            username\n            imageUrl\n            admin\n            joinDate\n        }\n    }\n"]);return E=function(){return e},e}function O(){var e=Object(b.a)(["\n    query user($username: String!) {\n        user(username: $username)  {\n            username\n            imageUrl\n            admin\n            joinDate\n        }\n    }\n"]);return O=function(){return e},e}function j(){var e=Object(b.a)(["\n    mutation createUser($username: String!, $password: String!) {\n        createUser(username: $username, password: $password)  {\n            value\n            user {\n                id\n                username\n                pinnedChats {\n                    title\n                }\n                admin\n                joinDate\n            }\n        }\n    }\n"]);return j=function(){return e},e}function v(){var e=Object(b.a)(["\n    mutation login($username: String!, $password: String!) {\n        login(username: $username, password: $password)  {\n            value\n            user {\n                id\n                username\n                pinnedChats {\n                    title\n                }\n                admin\n                joinDate\n            }\n        }\n    }\n"]);return v=function(){return e},e}var y,C=Object(f.a)(v()),w=Object(f.a)(j()),S=Object(f.a)(O()),k=Object(f.a)(E()),U=Object(f.a)(h()),L=Object(f.a)(p()),D=Object(f.a)(g()),T=n(10),F=n(164),x=n(36),z=n.n(x),R=n(56),I=function e(t,n){return function(){var a=Object(R.a)(z.a.mark((function a(r){return z.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:""!==t&&(clearTimeout(y),y=setTimeout((function(){r(e(""))}),1e3*n)),r({type:"SET NOTIFICATION",notification:t});case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET NOTIFICATION":return t.notification;default:return e}},N=function(){var e=Object(T.c)((function(e){return e.notification})),t={position:"absolute",width:"100%",textAlign:"center",zIndex:9999},n=Object(T.b)(),a=function(){n(I(""))};return""===e?c.a.createElement(c.a.Fragment,null):e.error?c.a.createElement(F.a,{style:t,variant:"danger",className:"errormessage",onClick:a},e.message):c.a.createElement(F.a,{style:t,variant:"success",className:"message",onClick:a},e.message)},B=function(e){return function(){var t=Object(R.a)(z.a.mark((function t(n){return z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SET_TOKEN",data:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TOKEN":return t.data;default:return e}},Q=function(e){return function(){var t=Object(R.a)(z.a.mark((function t(n){return z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SET_USER",data:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.data;default:return e}},V=n(17),A=function(){var e=Object(r.useState)(""),t=Object(u.a)(e,2),n=t[0],a=t[1],o=Object(r.useState)(""),i=Object(u.a)(o,2),b=i[0],f=i[1],g=Object(T.b)(),p=Object(l.g)(),h=Object(T.c)((function(e){return e.mode})),E=Object(d.a)(C,{onError:function(e){g(I({message:e.graphQLErrors[0].message,error:!0},10))}}),O=Object(u.a)(E,2),j=O[0],v=O[1];Object(r.useEffect)((function(){if(v.data){var e=v.data.login.value,t=v.data.login.user;g(B(e)),localStorage.setItem("user-token",e),p.push("/"),localStorage.setItem("logged-user",JSON.stringify(t)),g(Q(t)),g(I({message:"Logged in",error:!1},10))}}),[v.data]);var y={borderColor:"grey"};return y.backgroundColor="light"===h?"white":"darkgray",c.a.createElement(c.a.Fragment,null,c.a.createElement(N,null),c.a.createElement("div",{className:"container"},c.a.createElement("h2",null,"Login"),c.a.createElement(s.a,{onSubmit:function(e){e.preventDefault(),j({variables:{username:n,password:b}}),a(""),f("")}},c.a.createElement(s.a.Label,null,"username:"),c.a.createElement(s.a.Control,{type:"text",id:"username",style:y,value:n,name:"username",onChange:function(e){var t=e.target;return a(t.value)},required:!0}),c.a.createElement(s.a.Label,null,"password:"),c.a.createElement(s.a.Control,{type:"password",id:"password",style:y,value:b,name:"password",onChange:function(e){var t=e.target;return f(t.value)},required:!0}),c.a.createElement(m.a,{id:"submit",type:"submit"},"Login")," or ",c.a.createElement(V.b,{to:"/signin"},"Sign in"))))},W=n(119),J=n(121);function Z(){var e=Object(b.a)(["\n    mutation zeroReportChat($chatTitle: String!) {\n        zeroReportChat(chatTitle: $chatTitle)  {\n            title\n        }\n    }\n"]);return Z=function(){return e},e}function _(){var e=Object(b.a)(["\n    mutation unreportChat($chatTitle: String!) {\n        unreportChat(chatTitle: $chatTitle)  {\n            title\n        }\n    }\n"]);return _=function(){return e},e}function Y(){var e=Object(b.a)(["\n    mutation reportChat($chatTitle: String!) {\n        reportChat(chatTitle: $chatTitle)  {\n            title\n        }\n    }\n"]);return Y=function(){return e},e}function H(){var e=Object(b.a)(["\n    mutation unpinChat($chatTitle: String!) {\n        unpinChat(chatTitle: $chatTitle)  {\n            title\n        }\n    }\n"]);return H=function(){return e},e}function M(){var e=Object(b.a)(["\n    mutation pinChat($chatTitle: String!) {\n        pinChat(chatTitle: $chatTitle)  {\n            title\n        }\n    }\n"]);return M=function(){return e},e}function K(){var e=Object(b.a)(["\n    subscription {\n        chatDeleted {\n            title\n            id\n        }\n    }\n"]);return K=function(){return e},e}function G(){var e=Object(b.a)(["\n    subscription {\n        chatReported {\n            title\n            id\n            latestComment {\n                content\n                date\n                user {\n                    username\n                    admin\n                }\n            }\n            comments{\n                user { \n                    username\n                    imageUrl\n                    admin\n                }\n                date\n                content\n                imageUrl\n                hasVideo\n                reports\n                id\n            }\n            date\n            reports\n        }\n    }\n"]);return G=function(){return e},e}function X(){var e=Object(b.a)(["\n    subscription {\n        chatAdded {\n            title\n            latestComment {\n                content\n                date\n                user {\n                    username\n                    admin\n                }\n            }\n            date\n            id\n            reports\n        }\n    }\n"]);return X=function(){return e},e}function ee(){var e=Object(b.a)(["\n    query {\n        pinnedChats {\n            title\n        }\n    }\n"]);return ee=function(){return e},e}function te(){var e=Object(b.a)(["\n    query chat($chatTitle: String!){\n        chat(chatTitle: $chatTitle) {\n            comments {\n                user { \n                    username\n                    imageUrl\n                    admin\n                }\n                date\n                content\n                imageUrl\n                hasVideo\n                reports\n                id\n            }\n            title\n            reports\n        }\n    }\n"]);return te=function(){return e},e}function ne(){var e=Object(b.a)(["\n    query {\n        reportedChats {\n            title\n            latestComment{\n                content\n                date\n                user{\n                    username\n                    admin\n                }\n            }\n            id\n            date\n            reports\n        }\n    }\n"]);return ne=function(){return e},e}function ae(){var e=Object(b.a)(["\n    query {\n        pinnedChats {\n            title\n            latestComment{\n                content\n                date\n                user{\n                    username\n                    admin\n                }\n            }\n            id\n            date\n            reports\n        }\n    }\n"]);return ae=function(){return e},e}function re(){var e=Object(b.a)(["\n    query {\n        chats {\n            title\n            latestComment{\n                content\n                date\n                user{\n                    username\n                    admin\n                }\n            }\n            id\n            date\n            reports\n        }\n    }\n"]);return re=function(){return e},e}function ce(){var e=Object(b.a)(["\n    mutation deleteChat($chatId: String!) {\n        deleteChat(chatId: $chatId)  {\n            title\n        }\n    }\n"]);return ce=function(){return e},e}function oe(){var e=Object(b.a)(["\n    mutation createChat($chatTitle: String!) {\n        createChat(chatTitle: $chatTitle)  {\n            title\n        }\n    }\n"]);return oe=function(){return e},e}var ie=Object(f.a)(oe()),le=Object(f.a)(ce()),ue=Object(f.a)(re()),se=(Object(f.a)(ae()),Object(f.a)(ne())),me=Object(f.a)(te()),de=Object(f.a)(ee()),be=Object(f.a)(X()),fe=Object(f.a)(G()),ge=Object(f.a)(K()),pe=Object(f.a)(M()),he=Object(f.a)(H()),Ee=Object(f.a)(Y()),Oe=Object(f.a)(_()),je=Object(f.a)(Z());function ve(){var e=Object(b.a)(["\n    mutation zeroReportComment($commentId: String!) {\n        zeroReportComment(commentId: $commentId)  {\n            id\n        }\n    }\n"]);return ve=function(){return e},e}function ye(){var e=Object(b.a)(["\n    mutation unreportComment($commentId: String!) {\n        unreportComment(commentId: $commentId)  {\n            id\n        }\n    }\n"]);return ye=function(){return e},e}function Ce(){var e=Object(b.a)(["\n    mutation reportComment($commentId: String!) {\n        reportComment(commentId: $commentId)  {\n            id\n        }\n    }\n"]);return Ce=function(){return e},e}function we(){var e=Object(b.a)(["\n    subscription {\n        commentReported {\n            content\n            id\n            imageUrl\n            hasVideo\n            reports\n        }\n    }\n"]);return we=function(){return e},e}function Se(){var e=Object(b.a)(["\n    subscription {\n        commentEdited {\n            content\n            id\n            imageUrl\n            hasVideo\n            reports\n        }\n    }\n"]);return Se=function(){return e},e}function ke(){var e=Object(b.a)(["\n    mutation editComment($commentId: String!, $content: String!, $imageUrl: String) {\n        editComment(\n            commentId: $commentId\n            content: $content\n            imageUrl: $imageUrl\n        ){\n            content\n            id\n        }\n    }\n"]);return ke=function(){return e},e}function Ue(){var e=Object(b.a)(["\n    subscription {\n        commentDeleted {\n            content\n            imageUrl\n            reports\n            id\n        }\n    }\n"]);return Ue=function(){return e},e}function Le(){var e=Object(b.a)(["\n    mutation deleteComment($commentId: String!) {\n        deleteComment(commentId: $commentId)  {\n            content\n            id\n        }\n    }\n"]);return Le=function(){return e},e}function De(){var e=Object(b.a)(["\n    subscription {\n        commentAdded {\n            comment {\n                user { \n                    username\n                    imageUrl\n                    admin\n                }\n                date\n                content\n                imageUrl\n                hasVideo\n                reports\n                id\n            }\n            chatTitle\n        }\n    }\n"]);return De=function(){return e},e}function Te(){var e=Object(b.a)(["\n    query {\n        reportedComments {\n            content\n            date\n            imageUrl\n            hasVideo\n            id\n            user{\n                username\n                imageUrl\n                admin\n            }\n            reports\n        }\n    }\n"]);return Te=function(){return e},e}function Fe(){var e=Object(b.a)(["\n    mutation createComment($chatTitle: String!, $content: String!, $imageUrl: String) {\n        createComment(chatTitle: $chatTitle, content: $content, imageUrl: $imageUrl)  {\n            content\n            date\n            imageUrl\n            hasVideo\n            reports\n            id\n            user{\n                username\n                imageUrl\n                admin\n            }\n        }\n    }\n"]);return Fe=function(){return e},e}var xe,ze=Object(f.a)(Fe()),Re=Object(f.a)(Te()),Ie=Object(f.a)(De()),$e=Object(f.a)(Le()),Ne=Object(f.a)(Ue()),Be=Object(f.a)(ke()),Pe=Object(f.a)(Se()),Qe=Object(f.a)(we()),qe=Object(f.a)(Ce()),Ve=Object(f.a)(ye()),Ae=Object(f.a)(ve()),We=function(e){var t=e.chat,n=e.isPinned,a=e.submitPin,o=e.submitUnpin,i=Object(T.b)(),l=Object(T.c)((function(e){return e.user})),s="No comments yet.",b={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},f=new Date(t.date).toLocaleTimeString([],b);t.latestComment&&(s=t.latestComment.content.length>30?"".concat(t.latestComment.content.substring(0,30),"... -").concat(t.latestComment.user.username):"".concat(t.latestComment.content," -").concat(t.latestComment.user.username),t.latestComment.user.admin&&(s+="(admin)"),f=new Date(t.latestComment.date).toLocaleTimeString([],b));var g=Object(d.a)(le,{onError:function(e){i(I({message:e.graphQLErrors[0].message,error:!0},10))}}),p=Object(u.a)(g,2),h=p[0],E=(p[1],Object(d.a)(Ee,{onError:function(e){i(I({message:e.graphQLErrors[0].message,error:!0},10))}})),O=Object(u.a)(E,2),j=O[0],v=O[1];Object(r.useEffect)((function(){v.data&&i(I({message:"Chat reported",error:!1},10))}),[v.data]);var y=Object(d.a)(Oe,{onError:function(e){i(I({message:e.graphQLErrors[0].message,error:!0},10))}}),C=Object(u.a)(y,2),w=C[0],S=C[1];Object(r.useEffect)((function(){S.data&&i(I({message:"Chat unreported",error:!1},10))}),[S.data]);var k=Object(d.a)(je,{onError:function(e){i(I({message:e.graphQLErrors[0].message,error:!0},10))}}),U=Object(u.a)(k,2),L=U[0],D=U[1];Object(r.useEffect)((function(){D.loading&&D.called&&i(I({message:"Chat's reports zeroed",error:!1},10))}),[D]);return c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",padding:"10px",marginBottom:"10px"}},c.a.createElement("div",null,c.a.createElement(V.b,{to:"/chats/".concat(t.title)},t.title),l.admin?c.a.createElement(c.a.Fragment,null," Reports: ",t.reports.length):c.a.createElement(c.a.Fragment,null)),c.a.createElement("div",null,s),c.a.createElement("div",null,f,"\xa0",n?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return o(t)}},"Unpin"):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return a(t)}},"Pin"),l.admin?c.a.createElement(c.a.Fragment,null,t.reports.length>0?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Zero chat's reports?")&&L({variables:{chatTitle:t.title}})}},"Zero reports"):c.a.createElement(c.a.Fragment,null),c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Delete chat?")&&h({variables:{chatId:t.id}})}},"Delete")):c.a.createElement(c.a.Fragment,null,t.reports.includes(l.id)?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Unreport chat?")&&w({variables:{chatTitle:t.title}})}},"Unreport"):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Report chat?")&&j({variables:{chatTitle:t.title}})}},"Report"))))},Je=n(166),Ze=n(125),_e=function(){var e=Object(r.useState)(""),t=Object(u.a)(e,2),n=t[0],a=t[1],o=Object(T.b)(),i=Object(T.c)((function(e){return e.mode})),b=Object(l.g)(),f=Object(d.a)(ie,{onError:function(e){o(I({message:e.graphQLErrors[0].message,error:!0},10))}}),g=Object(u.a)(f,2),p=g[0],h=g[1];Object(r.useEffect)((function(){h.data&&(o(I({message:"New chat created",error:!1},10)),b.push("/chats/".concat(h.data.createChat.title)))}),[h.data]);var E={resize:"none",borderColor:"grey"};return E.backgroundColor="light"===i?"white":"darkgray",c.a.createElement(s.a,{onSubmit:function(e){e.preventDefault(),p({variables:{chatTitle:n}}),a("")}},c.a.createElement(Je.a,{size:"lg"},c.a.createElement(Ze.a,{md:"10",style:{paddingRight:"0",paddingLeft:"0"}},c.a.createElement(s.a.Control,{as:"textarea",rows:"1",style:E,id:"content",value:n,name:"content",onChange:function(e){var t=e.target;return a(t.value)},placeholder:"Title...",required:!0,block:"true"})),c.a.createElement(Ze.a,{md:"2",style:{paddingRight:"0",paddingLeft:"0"}},c.a.createElement(m.a,{style:{height:"100%"},id:"submit",type:"submit",size:"lg",block:"true"},"Start new chat"))))},Ye=function(){var e=Object(T.b)(),t=Object(T.c)((function(e){return e.mode})),n=Object(r.useState)([]),o=Object(u.a)(n,2),i=o[0],l=o[1],s=Object(W.a)(ue),b=Object(u.a)(s,2),f=b[0],g=b[1],p=Object(W.a)(de),h=Object(u.a)(p,2),E=h[0],O=h[1],j=Object(r.useState)([]),v=Object(u.a)(j,2),y=v[0],C=v[1],w=Object(r.useState)(""),S=Object(u.a)(w,2),k=S[0],U=S[1],L=Object(r.useState)(),D=Object(u.a)(L,2),F=D[0],x=D[1],z=Object(r.useState)(!1),R=Object(u.a)(z,2),$=R[0],N=R[1],B=Object(r.useState)(!1),P=Object(u.a)(B,2),Q=P[0],q=P[1],V=Object(r.useCallback)((function(e,t){if(!F)return 0;if(F.includes(e.title)&&!F.includes(t.title))return-1;if(!F.includes(e.title)&&F.includes(t.title))return 1;if(Q)return e.title.localeCompare(t.title);var n=e.date;e.latestComment&&(n=e.latestComment.date);var a=t.date;return t.latestComment&&(a=t.latestComment.date),a-n}),[F,Q]);Object(r.useEffect)((function(){f(),E()}),[]),Object(r.useEffect)((function(){g.data&&(l(g.data.chats.slice(0).sort(V)),C(i))}),[g.data]),Object(r.useEffect)((function(){O.data&&x(O.data.pinnedChats.map((function(e){return e.title})))}),[O.data]),Object(J.a)(be,{onSubscriptionData:function(e){var t=e.subscriptionData.data.chatAdded,n=i.concat(t);n.sort(V),l(n)}}),Object(J.a)(Ie,{onSubscriptionData:function(e){var t=e.subscriptionData,n=t.data.commentAdded.comment,r=t.data.commentAdded.chatTitle,c=i.map((function(e){return e.title===r?Object(a.a)({},e,{latestComment:n}):e}));c.sort(V),l(c)}}),Object(J.a)(fe,{onSubscriptionData:function(e){var t=e.subscriptionData.data.chatReported,n=i.map((function(e){return e.title===t.title?Object(a.a)({},e,{reports:t.reports}):e}));n.sort(V),l(n)}}),Object(r.useEffect)((function(){C(""===k?$?i.filter((function(e){return F.includes(e.title)})).sort(V):i.slice(0).sort(V):$?i.filter((function(e){return F.includes(e.title)})).filter((function(e){return e.title.toLowerCase().startsWith(k.toLowerCase())})).sort(V):i.filter((function(e){return e.title.toLowerCase().startsWith(k.toLowerCase())})).sort(V))}),[k,i,V,$,F,Q]);var A=Object(d.a)(pe,{onError:function(t){e(I({message:t.graphQLErrors[0].message,error:!0},10))}}),Z=Object(u.a)(A,2),_=Z[0],Y=Z[1],H=Object(d.a)(he,{onError:function(t){e(I({message:t.graphQLErrors[0].message,error:!0},10))}}),M=Object(u.a)(H,2),K=M[0],G=M[1],X=function(e){window.confirm("Pin chat?")&&_({variables:{chatTitle:e.title}})};Object(r.useEffect)((function(){Y.data&&(x(F.concat(Y.data.pinChat.title)),e(I({message:"Chat pinned",error:!1},10)))}),[Y.data]);var ee=function(e){window.confirm("Unpin chat?")&&K({variables:{chatTitle:e.title}})};Object(r.useEffect)((function(){G.data&&(x(F.filter((function(e){return e!==G.data.unpinChat.title}))),e(I({message:"Chat unpinned",error:!1},10)))}),[G.data]),Object(J.a)(ge,{onSubscriptionData:function(e){var t=e.subscriptionData.data.chatDeleted;l(i.filter((function(e){return e.id!==t.id})))}});var te={width:"100%",paddingBottom:"0",borderColor:"grey"};te.backgroundColor="light"===t?"white":"darkgray";var ne={paddingRight:"0",paddingLeft:"0"};return c.a.createElement("div",{style:{height:"100%"}},c.a.createElement(Je.a,null,c.a.createElement(Ze.a,{md:"8",style:ne},c.a.createElement("h2",{style:{display:"inline-block",marginBottom:"0"}},"Chats\xa0",Q?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return q(!1)}},"Sort by: title"):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return q(!0)}},"Sort by: activity"),$?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return N(!1)}},"Show all"):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return N(!0)}},"Show pinned"))),c.a.createElement(Ze.a,{md:"4",style:ne},c.a.createElement("input",{style:te,type:"text",value:k,onChange:function(e){var t=e.target;return U(t.value)},placeholder:"Filter chats by title..."}))),c.a.createElement(Je.a,null,c.a.createElement(Ze.a,{style:ne},c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",borderColor:"grey",padding:"10px",marginBottom:"0",overflowY:"scroll",height:"77.5vh"}},F?c.a.createElement(c.a.Fragment,null,0!==i.length?c.a.createElement(c.a.Fragment,null,y.map((function(e){return c.a.createElement(We,{key:e.id,chat:e,submitPin:X,submitUnpin:ee,isPinned:F.includes(e.title)})}))):c.a.createElement("div",null,"No chats yet")):c.a.createElement("div",null,"Loading")))),c.a.createElement(_e,null))},He=function(){var e=Object(T.b)(),t=Object(T.c)((function(e){return e.mode})),n=Object(T.c)((function(e){return e.user})),o=Object(l.g)(),i=Object(r.useState)([]),s=Object(u.a)(i,2),b=s[0],f=s[1],g=Object(W.a)(se),p=Object(u.a)(g,2),h=p[0],E=p[1],O=Object(W.a)(de),j=Object(u.a)(O,2),v=j[0],y=j[1],C=Object(r.useState)([]),w=Object(u.a)(C,2),S=w[0],k=w[1],U=Object(r.useState)(""),L=Object(u.a)(U,2),D=L[0],F=L[1],x=Object(r.useState)(),z=Object(u.a)(x,2),R=z[0],$=z[1],N=Object(r.useState)(!1),B=Object(u.a)(N,2),P=B[0],Q=B[1],q=Object(r.useState)(!1),V=Object(u.a)(q,2),A=V[0],Z=V[1],_=Object(r.useCallback)((function(e,t){if(!R)return 0;if(R.includes(e.title)&&!R.includes(t.title))return-1;if(!R.includes(e.title)&&R.includes(t.title))return 1;if(e.reports.length!==t.reports.length)return t.reports.length-e.reports.length;if(A)return e.title.localeCompare(t.title);var n=e.date;e.latestComment&&(n=e.latestComment.date);var a=t.date;return t.latestComment&&(a=t.latestComment.date),a-n}),[R,A]);Object(r.useEffect)((function(){n.admin||o.push("/error/Not authorized"),h(),v()}),[]),Object(r.useEffect)((function(){E.data&&(f(E.data.reportedChats.slice(0).sort(_)),k(b))}),[E.data]),Object(r.useEffect)((function(){y.data&&$(y.data.pinnedChats.map((function(e){return e.title})))}),[y.data]),Object(J.a)(be,{onSubscriptionData:function(e){var t=e.subscriptionData.data.chatAdded,n=b.concat(t);n.sort(_),f(n)}}),Object(J.a)(Ie,{onSubscriptionData:function(e){var t=e.subscriptionData,n=t.data.commentAdded.comment,r=t.data.commentAdded.chatTitle,c=b.map((function(e){return e.title===r?Object(a.a)({},e,{latestComment:n}):e}));c.sort(_),f(c)}}),Object(J.a)(fe,{onSubscriptionData:function(e){var t=e.subscriptionData.data.chatReported,n=[];(n=b.map((function(e){return e.title})).includes(t.title)?b.map((function(e){return e.title===t.title?Object(a.a)({},e,{reports:t.reports}):e})):b.concat(t)).sort(_),f(n.filter((function(e){return e.reports.length>0})))}}),Object(r.useEffect)((function(){k(""===D?P?b.filter((function(e){return R.includes(e.title)})).sort(_):b.slice(0).sort(_):P?b.filter((function(e){return R.includes(e.title)})).filter((function(e){return e.title.toLowerCase().startsWith(D.toLowerCase())})).sort(_):b.filter((function(e){return e.title.toLowerCase().startsWith(D.toLowerCase())})).sort(_))}),[D,b,_,P,R,A]);var Y=Object(d.a)(pe,{onError:function(t){e(I({message:t.graphQLErrors[0].message,error:!0},10))}}),H=Object(u.a)(Y,2),M=H[0],K=H[1],G=Object(d.a)(he,{onError:function(t){e(I({message:t.graphQLErrors[0].message,error:!0},10))}}),X=Object(u.a)(G,2),ee=X[0],te=X[1],ne=function(e){window.confirm("Pin chat?")&&M({variables:{chatTitle:e.title}})};Object(r.useEffect)((function(){K.data&&($(R.concat(K.data.pinChat.title)),e(I({message:"Chat pinned",error:!1},10)))}),[K.data]);var ae=function(e){window.confirm("Unpin chat?")&&ee({variables:{chatTitle:e.title}})};Object(r.useEffect)((function(){te.data&&($(R.filter((function(e){return e!==te.data.unpinChat.title}))),e(I({message:"Chat unpinned",error:!1},10)))}),[te.data]),Object(J.a)(ge,{onSubscriptionData:function(e){var t=e.subscriptionData.data.chatDeleted;f(b.filter((function(e){return e.id!==t.id})))}});var re={width:"100%",paddingBottom:"0",borderColor:"grey"};re.backgroundColor="light"===t?"white":"darkgray";var ce={paddingRight:"0",paddingLeft:"0"};return c.a.createElement("div",{style:{height:"100%"}},c.a.createElement(Je.a,null,c.a.createElement(Ze.a,{md:"8",style:ce},c.a.createElement("h2",{style:{display:"inline-block",marginBottom:"0"}},"Reported chats\xa0",A?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return Z(!1)}},"Sort by: title"):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return Z(!0)}},"Sort by: activity"),P?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return Q(!1)}},"Show all"):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return Q(!0)}},"Show pinned"))),c.a.createElement(Ze.a,{md:"4",style:ce},c.a.createElement("input",{style:re,type:"text",value:D,onChange:function(e){var t=e.target;return F(t.value)},placeholder:"Filter chats by title..."}))),c.a.createElement(Je.a,null,c.a.createElement(Ze.a,{style:ce},c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",borderColor:"grey",padding:"10px",marginBottom:"0",overflowY:"scroll",height:"77.5vh"}},R?c.a.createElement(c.a.Fragment,null,0!==b.length?c.a.createElement(c.a.Fragment,null,S.map((function(e){return c.a.createElement(We,{key:e.id,chat:e,submitPin:ne,submitUnpin:ae,isPinned:R.includes(e.title)})}))):c.a.createElement("div",null,"No reported chats")):c.a.createElement("div",null,"Loading")))))},Me=n(168),Ke=(n(151),n(173)),Ge=n(167),Xe=n(170),et=function(e){var t=e.imageUrl,n=e.hasVideo,a=Object(T.b)(),o=Object(r.useState)(!1),i=Object(u.a)(o,2),l=i[0],s=i[1];return t&&""!==t?n?c.a.createElement(c.a.Fragment,null,c.a.createElement("iframe",{width:"420",height:"315",frameBorder:"0",allowFullScreen:!0,title:"video",src:t}),c.a.createElement("br",null)):c.a.createElement(c.a.Fragment,null,c.a.createElement(Ke.a,{placement:"top",delay:{show:250,hide:400},overlay:c.a.createElement(Ge.a,null,"Click to expand")},c.a.createElement(Me.a,{src:t,onClick:function(){s(!0),a(I(""))},style:{maxWidth:"30%",maxHeight:"30%"}})),c.a.createElement(Xe.a,{show:l,size:"lg",onHide:function(){return s(!1)}},c.a.createElement(Xe.a.Header,{closeButton:!0}),c.a.createElement(Xe.a.Body,{style:{alignItems:"center",padding:"0",position:"absolute",maxWidth:"max-content",height:"auto",display:"block"}},c.a.createElement(Me.a,{src:t,style:{maxWidth:"max-content",height:"auto",display:"block"},fluid:!0}))),c.a.createElement("br",null)):c.a.createElement(c.a.Fragment,null)},tt=function(e){var t=e.comment,n=Object(T.b)(),a=Object(l.g)(),o=Object(T.c)((function(e){return e.user})),i=Object(T.c)((function(e){return e.mode})),s=Object(r.useState)(t.content),b=Object(u.a)(s,2),f=b[0],g=b[1],p=Object(r.useState)(!1),h=Object(u.a)(p,2),E=h[0],O=h[1],j=Object(r.useState)(t.imageUrl),v=Object(u.a)(j,2),y=v[0],C=v[1];Object(r.useEffect)((function(){t.imageUrl||C("")}),[]);var w=Object(d.a)($e,{onError:function(e){n(I({message:e.graphQLErrors[0].message,error:!0},10))}}),S=Object(u.a)(w,2),k=S[0],U=S[1],L=Object(d.a)(Be,{onError:function(e){n(I({message:e.graphQLErrors[0].message,error:!0},10))}}),D=Object(u.a)(L,2),F=D[0],x=D[1];Object(r.useEffect)((function(){U.called&&U.loading&&n(I({message:"Comment deleted",error:!1},10))}),[U]);var z=c.a.createElement(c.a.Fragment,null);t.user.imageUrl&&(z=c.a.createElement(c.a.Fragment,null,c.a.createElement(Me.a,{style:{height:"10%",width:"10%"},src:t.user.imageUrl,onClick:function(){return a.push("/users/".concat(t.user.username))},fluid:!0})));Object(r.useEffect)((function(){x.data&&(O(!1),n(I({message:"Comment edited",error:!1},10)))}),[x.data]);Object(r.useEffect)((function(){g(t.content)}),[t]);var R=Object(d.a)(qe,{onError:function(e){n(I({message:e.graphQLErrors[0].message,error:!0},10))}}),$=Object(u.a)(R,2),N=$[0],B=$[1];Object(r.useEffect)((function(){B.data&&n(I({message:"Comment reported",error:!1},10))}),[B.data]);var P=Object(d.a)(Ve,{onError:function(e){n(I({message:e.graphQLErrors[0].message,error:!0},10))}}),Q=Object(u.a)(P,2),q=Q[0],A=Q[1];Object(r.useEffect)((function(){A.data&&n(I({message:"Comment unreported",error:!1},10))}),[A.data]);var W=Object(d.a)(Ae,{onError:function(e){n(I({message:e.graphQLErrors[0].message,error:!0},10))}}),J=Object(u.a)(W,2),Z=J[0],_=J[1];Object(r.useEffect)((function(){_.called&&_.loading&&n(I({message:"Comment's reports zeroed",error:!1},10))}),[_]);var Y={width:"100%",resize:"none",border:"none"},H={borderColor:"grey",width:"100%"};"light"===i?(Y.backgroundColor="white",H.backgroundColor="white",Y.color="black"):(Y.backgroundColor="#1a1a1a",Y.color="darkgray",H.backgroundColor="darkgray");var M=new Date(t.date).toLocaleTimeString([],{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",padding:"10px",marginBottom:"10px"}},c.a.createElement("div",null,z," ",c.a.createElement(V.b,{to:"/users/".concat(t.user.username)},t.user.username),t.user.admin?c.a.createElement("span",null,"(admin)"):c.a.createElement(c.a.Fragment,null)," ",M,o.admin?c.a.createElement(c.a.Fragment,null," Reports: ",t.reports.length):c.a.createElement(c.a.Fragment,null)),c.a.createElement("textarea",{rows:"2",value:f,readOnly:!E,style:Y,onChange:function(e){var t=e.target;return g(t.value)},block:"true"}),c.a.createElement(et,{imageUrl:t.imageUrl,hasVideo:t.hasVideo}),E?c.a.createElement(c.a.Fragment,null,c.a.createElement("input",{type:"text",style:H,placeholder:"Image/video url...",value:y,onChange:function(e){var t=e.target;return C(t.value)},block:"true"}),c.a.createElement("br",null)):c.a.createElement(c.a.Fragment,null),o.username===t.user.username||o.admin||"Comment deleted"===t.content?c.a.createElement(c.a.Fragment,null):c.a.createElement(c.a.Fragment,null,t.reports.includes(o.id)?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Unreport comment?")&&q({variables:{commentId:t.id}})}},"Unreport"):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Report comment?")&&N({variables:{commentId:t.id}})}},"Report")),o.admin?c.a.createElement(c.a.Fragment,null,t.reports.length>0?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Zero comment's reports?")&&Z({variables:{commentId:t.id}})}},"Zero reports"):c.a.createElement(c.a.Fragment,null)):c.a.createElement(c.a.Fragment,null),o.username!==t.user.username&&!o.admin||"Comment deleted"===t.content?c.a.createElement(c.a.Fragment,null):c.a.createElement(c.a.Fragment,null,c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Delete comment?")&&k({variables:{commentId:t.id}})}},"Delete comment"),E?c.a.createElement(c.a.Fragment,null,c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){O(!1),C(t.imageUrl),g(t.content)}},"Stop editing"),c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Edit comment?")&&F({variables:{commentId:t.id,content:f,imageUrl:y}})}},"Submit edit")):c.a.createElement(c.a.Fragment,null,o.username===t.user.username?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){O(!0),t.content.endsWith(" -edited")&&g(t.content.substring(0,t.content.length-8))}},"Start editing"):c.a.createElement(c.a.Fragment,null))))},nt=function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),n=t[0],o=t[1],i=Object(l.g)(),s=Object(T.c)((function(e){return e.mode})),m=Object(T.c)((function(e){return e.user})),d=Object(r.useState)([]),b=Object(u.a)(d,2),f=b[0],g=b[1],p=Object(r.useState)(""),h=Object(u.a)(p,2),E=h[0],O=h[1],j=Object(W.a)(Re),v=Object(u.a)(j,2),y=v[0],C=v[1],w=Object(r.useRef)(null),S=Object(r.useState)(!0),k=Object(u.a)(S,2),U=k[0],L=k[1],D=function(e,t){return e.reports.length!==t.reports.length?t.reports.length-e.reports.length:e.date-t.date},F=function(){w.current&&w.current.scrollIntoView({behavior:"smooth"})};Object(r.useEffect)((function(){m.admin||i.push("/error/Not authorized"),console.log("oi"),y()}),[]),Object(r.useEffect)((function(){console.log(C),C.data&&(console.log(C.data),L(!0),o(C.data.reportedComments.sort(D)),setTimeout((function(){F()}),200),setTimeout((function(){F()}),300))}),[C]),Object(r.useEffect)((function(){U&&(F(),L(!1))}),[f]),Object(J.a)(Ne,{onSubscriptionData:function(e){var t=e.subscriptionData.data.commentDeleted;o(n.filter((function(e){return e.id!==t.id})))}}),Object(J.a)(Pe,{onSubscriptionData:function(e){var t=e.subscriptionData.data.commentEdited;o(n.map((function(e){return e.id===t.id?Object(a.a)({},e,{content:t.content,imageUrl:t.imageUrl,hasVideo:t.hasVideo}):e})))}}),Object(r.useEffect)((function(){g(""===E?n:n.filter((function(e){return e.content.toLowerCase().includes(E.toLowerCase())})))}),[E,n]),Object(J.a)(Qe,{onSubscriptionData:function(e){var t=e.subscriptionData.data.commentReported,r=[];(r=n.map((function(e){return e.id})).includes(t.id)?n.map((function(e){return e.id===t.id?Object(a.a)({},e,{reports:t.reports}):e})):n.concat(t)).sort(D),o(r.filter((function(e){return e.reports.length>0})))}});var x={width:"100%",paddingBottom:"0",borderColor:"grey"};x.backgroundColor="light"===s?"white":"darkgray";var z={paddingRight:"0",paddingLeft:"0"};return c.a.createElement(c.a.Fragment,null,c.a.createElement(Je.a,null,c.a.createElement(Ze.a,{md:"8",style:z},c.a.createElement("h2",{style:{display:"inline-block",marginBottom:"0"}},"Reported comments")),c.a.createElement(Ze.a,{md:"4",style:z},c.a.createElement("input",{style:x,type:"text",value:E,onChange:function(e){var t=e.target;L(!0),O(t.value)},placeholder:"Filter comments by content..."}))),c.a.createElement(Je.a,null,c.a.createElement(Ze.a,{style:z},c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",borderColor:"grey",padding:"10px",marginBottom:"0",overflowY:"scroll",height:"77.5vh",width:"100%"}},0===n.length?c.a.createElement("div",null,"No reported comments"):c.a.createElement(c.a.Fragment,null,f.map((function(e){return c.a.createElement(tt,{key:e.id,comment:e})}))),c.a.createElement("div",{ref:w})))))},at=function(e){var t=e.title,n=Object(r.useState)(""),a=Object(u.a)(n,2),o=a[0],i=a[1],l=Object(r.useState)(""),b=Object(u.a)(l,2),f=b[0],g=b[1],p=Object(T.b)(),h=Object(T.c)((function(e){return e.mode})),E=Object(d.a)(ze,{onCompleted:function(){i(""),g("")},onError:function(e){p(I({message:e.graphQLErrors[0].message,error:!0},10))}}),O=Object(u.a)(E,2),j=O[0],v=(O[1],{resize:"none",borderColor:"grey"}),y={borderColor:"grey"};return"light"===h?(v.backgroundColor="white",y.backgroundColor="white"):(v.backgroundColor="darkgray",y.backgroundColor="darkgray"),c.a.createElement(s.a,{onSubmit:function(e){e.preventDefault(),j({variables:{chatTitle:t,content:o,imageUrl:f}})}},c.a.createElement(Je.a,{size:"lg"},c.a.createElement(Ze.a,{md:"10",style:{paddingRight:"0",paddingLeft:"0"}},c.a.createElement(s.a.Control,{as:"textarea",rows:"2",style:v,id:"content",value:o,name:"content",onChange:function(e){var t=e.target;return i(t.value)},placeholder:"New comment...",required:!0,block:"true"}),c.a.createElement(s.a.Control,{style:y,size:"sm",type:"text",placeholder:"Image/video url...",value:f,name:"imageUrl",id:"imageUrl",onChange:function(e){var t=e.target;return g(t.value)},block:"true"})),c.a.createElement(Ze.a,{md:"2",style:{paddingLeft:"0",paddingRight:"0"}},c.a.createElement(m.a,{style:{height:"100%"},id:"submit",type:"submit",size:"lg",block:!0},"Send"))))},rt=function(e){var t=e.title,n=Object(r.useState)(null),o=Object(u.a)(n,2),i=o[0],s=o[1],b=Object(r.useState)([]),f=Object(u.a)(b,2),g=f[0],p=f[1],h=Object(l.g)(),E=Object(T.b)(),O=Object(T.c)((function(e){return e.mode})),j=Object(T.c)((function(e){return e.user})),v=Object(r.useState)([]),y=Object(u.a)(v,2),C=y[0],w=y[1],S=Object(r.useState)(""),k=Object(u.a)(S,2),U=k[0],L=k[1],D=Object(W.a)(me),F=Object(u.a)(D,2),x=F[0],z=F[1],R=Object(W.a)(de),$=Object(u.a)(R,2),N=$[0],B=$[1],P=Object(r.useState)(),Q=Object(u.a)(P,2),q=Q[0],V=Q[1],A=Object(r.useRef)(null),Z=Object(r.useState)(!0),_=Object(u.a)(Z,2),Y=_[0],H=_[1],M=function(){A.current&&A.current.scrollIntoView({behavior:"smooth"})};Object(r.useEffect)((function(){x({variables:{chatTitle:t}}),N()}),[]),Object(r.useEffect)((function(){x({variables:{chatTitle:t}}),N()}),[t]),Object(r.useEffect)((function(){z.data?(H(!0),p(z.data.chat.comments.sort((function(e,t){return e.date-t.date}))),s(z.data.chat),setTimeout((function(){M()}),200),setTimeout((function(){M()}),300)):z.called&&!z.loading&&h.push("/error/Chat does not exist")}),[z]),Object(r.useEffect)((function(){B.data&&V(B.data.pinnedChats.map((function(e){return e.title})))}),[B.data]),Object(r.useEffect)((function(){Y&&(M(),H(!1))}),[C]),Object(J.a)(Ie,{onSubscriptionData:function(e){var n=e.subscriptionData,a=n.data.commentAdded.comment;if(n.data.commentAdded.chatTitle===t){H(!0);var r=g.concat(a);r.sort((function(e,t){return e.date-t.date})),p(r)}}}),Object(J.a)(Ne,{onSubscriptionData:function(e){var t=e.subscriptionData.data.commentDeleted;p(g.map((function(e){return e.id===t.id?Object(a.a)({},e,{content:t.content,imageUrl:t.imageUrl,reports:t.reports}):e})))}}),Object(J.a)(Pe,{onSubscriptionData:function(e){var t=e.subscriptionData.data.commentEdited;p(g.map((function(e){return e.id===t.id?Object(a.a)({},e,{content:t.content,imageUrl:t.imageUrl,hasVideo:t.hasVideo}):e})))}}),Object(r.useEffect)((function(){w(""===U?g:g.filter((function(e){return e.content.toLowerCase().includes(U.toLowerCase())})))}),[U,g]);var K=Object(d.a)(Ee,{onError:function(e){E(I({message:e.graphQLErrors[0].message,error:!0},10))}}),G=Object(u.a)(K,2),X=G[0],ee=G[1];Object(r.useEffect)((function(){ee.data&&E(I({message:"Chat reported",error:!1},10))}),[ee.data]);var te=Object(d.a)(Oe,{onError:function(e){E(I({message:e.graphQLErrors[0].message,error:!0},10))}}),ne=Object(u.a)(te,2),ae=ne[0],re=ne[1];Object(r.useEffect)((function(){re.data&&E(I({message:"Chat unreported",error:!1},10))}),[re.data]);var ce=Object(d.a)(je,{onError:function(e){E(I({message:e.graphQLErrors[0].message,error:!0},10))}}),oe=Object(u.a)(ce,2),ie=oe[0],le=oe[1];Object(r.useEffect)((function(){le.data&&E(I({message:"Chat's reports zeroed",error:!1},10))}),[le.data]),Object(J.a)(fe,{onSubscriptionData:function(e){var n=e.subscriptionData.data.chatReported;n.title===t&&s(n)}});var ue=Object(d.a)(pe,{onError:function(e){E(I({message:e.graphQLErrors[0].message,error:!0},10))}}),se=Object(u.a)(ue,2),be=se[0],ge=se[1],ve=Object(d.a)(he,{onError:function(e){E(I({message:e.graphQLErrors[0].message,error:!0},10))}}),ye=Object(u.a)(ve,2),Ce=ye[0],we=ye[1];Object(r.useEffect)((function(){ge.data&&(V(q.concat(ge.data.pinChat.title)),E(I({message:"Chat pinned",error:!1},10)))}),[ge.data]);Object(r.useEffect)((function(){we.data&&(V(q.filter((function(e){return e!==we.data.unpinChat.title}))),E(I({message:"Chat unpinned",error:!1},10)))}),[we.data]),Object(J.a)(Qe,{onSubscriptionData:function(e){var t=e.subscriptionData.data.commentReported,n=g.map((function(e){return e.id===t.id?Object(a.a)({},e,{reports:t.reports}):e}));p(n)}});var Se={width:"100%",paddingBottom:"0",borderColor:"grey",paddingRight:"0",paddingLeft:"0"};Se.backgroundColor="light"===O?"white":"darkgray";var ke={paddingRight:"0",paddingLeft:"0"};return c.a.createElement(c.a.Fragment,null,c.a.createElement(Je.a,null,c.a.createElement(Ze.a,{md:"8",style:ke},t.startsWith("userChat")?c.a.createElement("h2",{style:{display:"inline-block",marginBottom:"0"}},"".concat(t.substring(8),"'s chat")):c.a.createElement("h2",{style:{display:"inline-block",marginBottom:"0"}},t,"\xa0",q&&q.includes(t)?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Unpin chat?")&&Ce({variables:{chatTitle:t}})}},"Unpin"):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Pin chat?")&&be({variables:{chatTitle:t}})}},"Pin"),j.admin?c.a.createElement(c.a.Fragment,null,i&&i.reports.length>0?c.a.createElement(c.a.Fragment,null,c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Zero chat's reports?")&&ie({variables:{chatTitle:t}})}},"Zero reports")," ",c.a.createElement("span",{style:{fontSize:"1rem"}}," Reports: ",i.reports.length)):c.a.createElement(c.a.Fragment,null)):c.a.createElement(c.a.Fragment,null,i&&i.reports&&i.reports.includes(j.id)?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Unreport chat?")&&ae({variables:{chatTitle:t}})}},"Unreport"):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Report chat?")&&X({variables:{chatTitle:t}})}},"Report")))),c.a.createElement(Ze.a,{md:"4",style:ke},c.a.createElement("input",{style:Se,type:"text",value:U,onChange:function(e){var t=e.target;H(!0),L(t.value)},placeholder:"Filter comments by content..."}))),c.a.createElement(Je.a,null,c.a.createElement(Ze.a,{style:ke},c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",borderColor:"grey",padding:"10px",marginBottom:"0",overflowY:"scroll",height:"70vh",width:"100%"}},0===g.length?c.a.createElement("div",null,"No comments yet"):C.map((function(e){return c.a.createElement(tt,{key:e.id,comment:e})})),c.a.createElement("div",{ref:A})))),c.a.createElement(at,{title:t}))},ct=function(){var e=Object(l.h)("/chats/:title"),t=e?e.params.title:null;return c.a.createElement("div",null,c.a.createElement(rt,{title:t}))},ot=function(){var e=Object(T.b)(),t=Object(l.g)(),n=Object(T.c)((function(e){return e.user})),o=Object(T.c)((function(e){return e.mode})),i=Object(l.h)("/users/:username"),s=Object(r.useState)(null),b=Object(u.a)(s,2),f=b[0],g=b[1],p=Object(r.useState)(""),h=Object(u.a)(p,2),E=h[0],O=h[1],j=Object(r.useState)(!1),v=Object(u.a)(j,2),y=v[0],C=v[1],w=i?i.params.username:null,k=Object(W.a)(S),D=Object(u.a)(k,2),F=D[0],x=D[1],z=Object(r.useState)(c.a.createElement(c.a.Fragment,null)),R=Object(u.a)(z,2),$=R[0],N=R[1];Object(r.useEffect)((function(){F({variables:{username:w}})}),[w]),Object(r.useEffect)((function(){x.data?g(x.data.user):x.called&&!x.loading&&t.push("/error/User does not exist")}),[x]);var B=Object(d.a)(U,{onError:function(t){e(I({message:t.graphQLErrors[0].message,error:!0},10))}}),P=Object(u.a)(B,2),Q=P[0],q=P[1];Object(r.useEffect)((function(){q.data&&(e(I({message:"Profile picture set",error:!1},10)),g(Object(a.a)({},f,{imageUrl:q.data.setUserProfilePic.imageUrl})),O(""),C(!1))}),[q.data]);var V=Object(d.a)(L,{onError:function(t){e(I({message:t.graphQLErrors[0].message,error:!0},10))}}),A=Object(u.a)(V,2),J=A[0],Z=A[1];Object(r.useEffect)((function(){Z.data&&(e(I({message:"Profile picture deleted",error:!1},10)),g(Object(a.a)({},f,{imageUrl:null})),O(""),C(!1),N(c.a.createElement(c.a.Fragment,null)))}),[Z.data]);Object(r.useEffect)((function(){f&&f.imageUrl&&N(c.a.createElement(c.a.Fragment,null,c.a.createElement(Me.a,{style:{height:"100%",width:"100%"},src:f.imageUrl,fluid:!0}),c.a.createElement("br",null)))}),[f]);var _={borderColor:"grey",width:"100%"};return _.backgroundColor="light"===o?"white":"darkgray",c.a.createElement(c.a.Fragment,null,f?c.a.createElement(Je.a,null,c.a.createElement(Ze.a,{md:"3"},c.a.createElement(Je.a,null,c.a.createElement("div",null,$)),c.a.createElement(Je.a,null,c.a.createElement("h2",{style:{marginBottom:"0px"}},f.username)),c.a.createElement(Je.a,null,"Joined: ",new Date(f.joinDate).toLocaleDateString([],{weekday:"long",year:"numeric",month:"long",day:"numeric"})),c.a.createElement(Je.a,null,f.username===n.username?c.a.createElement(c.a.Fragment,null,y?c.a.createElement(Ze.a,{style:{paddingLeft:"0"}},c.a.createElement("input",{type:"text",style:_,placeholder:"Url of the image...",value:E,onChange:function(e){var t=e.target;return O(t.value)}}),c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){C(!1),O("")}},"Back"),f.imageUrl?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Delete profile picture?")&&J()}},"Delete image"):c.a.createElement(c.a.Fragment,null),c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Set profile picture?")&&Q({variables:{imageUrl:E}})}},"Submit image")):c.a.createElement(Ze.a,{style:{paddingLeft:"0"}},c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return C(!0)}},"Set image"))):c.a.createElement(c.a.Fragment,null))),c.a.createElement(Ze.a,{md:"9"},c.a.createElement("div",null,c.a.createElement(rt,{title:"userChat".concat(w)})))):c.a.createElement(c.a.Fragment,null))},it=function(e){var t=e.user,n=Object(l.g)(),a=c.a.createElement(c.a.Fragment,null);t.imageUrl&&(a=c.a.createElement(c.a.Fragment,null,c.a.createElement(Me.a,{style:{height:"10%",width:"10%"},src:t.imageUrl,onClick:function(){return n.push("/users/".concat(t.username))},fluid:!0})));return c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",padding:"10px",marginBottom:"10px"}},c.a.createElement("div",null,a," ",c.a.createElement(V.b,{to:"/users/".concat(t.username)},t.username),t.admin?c.a.createElement("span",null,"(admin)"):c.a.createElement(c.a.Fragment,null)," Joined: ",new Date(t.joinDate).toLocaleDateString([],{weekday:"long",year:"numeric",month:"long",day:"numeric"})))},lt=function(){var e=Object(T.c)((function(e){return e.mode})),t=Object(W.a)(k),n=Object(u.a)(t,2),a=n[0],o=n[1],i=Object(r.useState)([]),l=Object(u.a)(i,2),s=l[0],d=l[1],b=Object(r.useState)([]),f=Object(u.a)(b,2),g=f[0],p=f[1],h=Object(r.useState)(""),E=Object(u.a)(h,2),O=E[0],j=E[1],v=Object(r.useState)(!0),y=Object(u.a)(v,2),C=y[0],w=y[1],S=Object(r.useCallback)((function(e,t){return C?e.username.localeCompare(t.username):e.joinDate-t.joinDate}),[C]);Object(r.useEffect)((function(){a()}),[]),Object(r.useEffect)((function(){o.data&&(d(o.data.users.slice(0).sort(S)),p(s))}),[o.data]),Object(r.useEffect)((function(){p(""===O?s.slice(0).sort(S):s.filter((function(e){return e.username.toLowerCase().startsWith(O.toLowerCase())})).sort(S))}),[O,s,C,S]),Object(J.a)(D,{onSubscriptionData:function(e){var t=e.subscriptionData.data.userCreated,n=s.concat(t);n.sort(S),d(n)}});var U={width:"100%",paddingBottom:"0",borderColor:"grey"};U.backgroundColor="light"===e?"white":"darkgray";var L={paddingRight:"0",paddingLeft:"0"};return c.a.createElement("div",{style:{height:"100%"}},c.a.createElement(Je.a,null,c.a.createElement(Ze.a,{md:"8",style:L},c.a.createElement("h2",{style:{display:"inline-block",marginBottom:"0"}},"Users\xa0",C?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return w(!1)}},"Sort by: username"):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return w(!0)}},"Sort by: joined date"))),c.a.createElement(Ze.a,{md:"4",style:L},c.a.createElement("input",{style:U,type:"text",value:O,onChange:function(e){var t=e.target;return j(t.value)},placeholder:"Filter users by username..."}))),c.a.createElement(Je.a,null,c.a.createElement(Ze.a,{style:L},c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",borderColor:"grey",padding:"10px",marginBottom:"0",overflowY:"scroll",height:"82.5vh"}},g.map((function(e){return c.a.createElement(it,{key:e.username,user:e})}))))))},ut=function(){var e=Object(l.h)("/error/:errormessage"),t=e?e.params.errormessage:null;return c.a.createElement("h2",null,t)},st=n(169),mt=function(){return c.a.createElement(st.a,{style:{height:"100%"}},c.a.createElement(l.d,null,c.a.createElement(l.b,{path:"/error/:errormessage"},c.a.createElement(ut,null)),c.a.createElement(l.b,{path:"/reported/chats"},c.a.createElement(He,null)),c.a.createElement(l.b,{path:"/reported/comments"},c.a.createElement(nt,null)),c.a.createElement(l.b,{path:"/chats/:title"},c.a.createElement(ct,null)),c.a.createElement(l.b,{path:"/chats"},c.a.createElement(Ye,null)),c.a.createElement(l.b,{path:"/users/:username"},c.a.createElement(ot,null)),c.a.createElement(l.b,{path:"/users"},c.a.createElement(lt,null)),c.a.createElement(l.b,{path:"/"},c.a.createElement(l.a,{to:"/chats"}))))},dt=function(){var e=Object(r.useState)(""),t=Object(u.a)(e,2),n=t[0],a=t[1],o=Object(r.useState)(""),i=Object(u.a)(o,2),b=i[0],f=i[1],g=Object(T.b)(),p=Object(l.g)(),h=Object(T.c)((function(e){return e.mode})),E=Object(d.a)(w,{onError:function(e){g(I({message:e.graphQLErrors[0].message,error:!0},10))}}),O=Object(u.a)(E,2),j=O[0],v=O[1];Object(r.useEffect)((function(){if(v.data){var e=v.data.createUser.value,t=v.data.createUser.user;g(B(e)),localStorage.setItem("user-token",e),p.push("/"),localStorage.setItem("logged-user",JSON.stringify(t)),g(Q(t)),g(I({message:"Signed in",error:!1},10))}}),[v.data]);var y={borderColor:"grey"};return y.backgroundColor="light"===h?"white":"darkgray",c.a.createElement(c.a.Fragment,null,c.a.createElement(N,null),c.a.createElement("div",{className:"container"},c.a.createElement("h2",null,"Sign in"),c.a.createElement(s.a,{onSubmit:function(e){e.preventDefault(),j({variables:{username:n,password:b}}),a(""),f("")}},c.a.createElement(s.a.Label,null,"username:"),c.a.createElement(s.a.Control,{type:"text",id:"username",style:y,value:n,name:"username",onChange:function(e){var t=e.target;return a(t.value)},required:!0}),c.a.createElement(s.a.Label,null,"password:"),c.a.createElement(s.a.Control,{type:"password",id:"password",style:y,value:b,name:"password",onChange:function(e){var t=e.target;return f(t.value)},required:!0}),c.a.createElement(m.a,{id:"submit",type:"submit"},"Sign in")," or ",c.a.createElement(V.b,{to:"/login"},"Login"))))},bt=n(174),ft=n(172),gt=function(e){return function(){var t=Object(R.a)(z.a.mark((function t(n){return z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SET_MODE",data:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},pt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MODE":return localStorage.setItem("mode",t.data),t.data;default:return e}},ht=function(){var e=Object(T.c)((function(e){return e.user})),t=Object(T.c)((function(e){return e.mode})),n=Object(T.b)(),a=Object(l.g)(),r=function(){window.localStorage.removeItem("user-token"),window.localStorage.removeItem("logged-user"),n(Q(null)),n(B("")),n(I({message:"Logged out",error:!1},5)),a.push("/login")};return e?e.admin?c.a.createElement(c.a.Fragment,null,c.a.createElement(bt.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark"},c.a.createElement(bt.a.Brand,{href:"",as:"span"},"ChatForum"),c.a.createElement(ft.a,{className:"mr-auto"},c.a.createElement(ft.a.Link,{href:"#",as:"span",style:{paddingLeft:"0",paddingRight:"0"}},"light"===t?c.a.createElement(m.a,{variant:"outline-info",onClick:function(){return n(gt("dark"))}},"Dark mode"):c.a.createElement(m.a,{variant:"outline-info",onClick:function(){return n(gt("light"))}},"Light mode"))),c.a.createElement(bt.a.Collapse,{id:"responsive-navbar-nav"},c.a.createElement(ft.a,{className:"mr-auto"},c.a.createElement(ft.a.Link,{href:"#",as:"span",style:{paddingLeft:"0",paddingRight:"0"}},c.a.createElement(m.a,{variant:"outline-info",onClick:function(){a.push("/chats")}},"Chats"),c.a.createElement(m.a,{variant:"outline-info",onClick:function(){a.push("/users")}},"Users"),c.a.createElement(m.a,{variant:"outline-info",onClick:function(){a.push("/reported/chats")}},"Reported chats"),c.a.createElement(m.a,{variant:"outline-info",onClick:function(){a.push("/reported/comments")}},"Reported comments")))),c.a.createElement(ft.a,{className:"mr-auto"},c.a.createElement(ft.a.Link,{href:"#",as:"span"},c.a.createElement(bt.a.Text,{style:{padding:"0"}},c.a.createElement(V.b,{to:"/users/".concat(e.username)},e.username)," logged in ",c.a.createElement(m.a,{variant:"outline-info",onClick:r},"Logout"),c.a.createElement(bt.a.Toggle,{"aria-controls":"responsive-navbar-nav"}))))),c.a.createElement(N,null)):c.a.createElement(c.a.Fragment,null,c.a.createElement(bt.a,{collapseOnSelect:!0,expand:"md",bg:"dark",variant:"dark"},c.a.createElement(bt.a.Brand,{href:"",as:"span"},"ChatForum"),c.a.createElement(ft.a,{className:"mr-auto"},c.a.createElement(ft.a.Link,{href:"#",as:"span",style:{paddingLeft:"0",paddingRight:"0"}},"light"===t?c.a.createElement(m.a,{variant:"outline-info",onClick:function(){return n(gt("dark"))}},"Dark mode"):c.a.createElement(m.a,{variant:"outline-info",onClick:function(){return n(gt("light"))}},"Light mode"))),c.a.createElement(bt.a.Collapse,{id:"responsive-navbar-nav"},c.a.createElement(ft.a,{className:"mr-auto"},c.a.createElement(ft.a.Link,{href:"#",as:"span",style:{paddingLeft:"0",paddingRight:"0"}},c.a.createElement(m.a,{variant:"outline-info",onClick:function(){a.push("/chats")}},"Chats"),c.a.createElement(m.a,{variant:"outline-info",onClick:function(){a.push("/users")}},"Users")))),c.a.createElement(ft.a,{className:"mr-auto"},c.a.createElement(ft.a.Link,{href:"#",as:"span"},c.a.createElement(bt.a.Text,{style:{padding:"0"}},c.a.createElement(V.b,{to:"/users/".concat(e.username)},e.username)," logged in ",c.a.createElement(m.a,{variant:"outline-info",onClick:r},"Logout"),c.a.createElement(bt.a.Toggle,{"aria-controls":"responsive-navbar-nav"}))))),c.a.createElement(N,null)):c.a.createElement(c.a.Fragment,null,c.a.createElement(bt.a,{collapseOnSelect:!0,bg:"dark",variant:"dark"},c.a.createElement(bt.a.Brand,{href:"",as:"span"},"ChatForum"),c.a.createElement(bt.a.Collapse,{id:"responsive-navbar-nav"},c.a.createElement(ft.a,{className:"mr-auto"},c.a.createElement(ft.a.Link,{href:"#",as:"span"},"light"===t?c.a.createElement(m.a,{variant:"outline-info",onClick:function(){return n(gt("dark"))}},"Dark mode"):c.a.createElement(m.a,{variant:"outline-info",onClick:function(){return n(gt("light"))}},"Light mode"))))),c.a.createElement(N,null))},Et=function(){var e=Object(T.c)((function(e){return e.token}));return"light"===Object(T.c)((function(e){return e.mode}))?(document.body.style.backgroundColor="white",document.body.style.color="black"):(document.body.style.backgroundColor="#1a1a1a",document.body.style.color="darkgray"),c.a.createElement("div",{style:{width:"100%",height:"100%",left:0,top:0,zIndex:10}},c.a.createElement(ht,null),c.a.createElement(l.d,null,c.a.createElement(l.b,{path:"/signin"},e?c.a.createElement(l.a,{to:"/chats"}):c.a.createElement(dt,null)),c.a.createElement(l.b,{path:"/login"},e?c.a.createElement(l.a,{to:"/chats"}):c.a.createElement(A,null)),c.a.createElement(l.b,{path:"/"},e?c.a.createElement(c.a.Fragment,null,c.a.createElement(mt,null)):c.a.createElement(l.a,{to:"/login"}))))},Ot=n(68),jt=n(86),vt=n(87),yt=n(88),Ct=n(118),wt=n(132),St=n(129),kt=n(114),Ut=n(64),Lt=n(130),Dt=n(131),Tt=Object(Ut.combineReducers)({notification:$,user:q,token:P,mode:pt}),Ft=Object(Ut.createStore)(Tt,Object(Lt.composeWithDevTools)(Object(Ut.applyMiddleware)(Dt.a))),xt=Object(wt.a)((function(e,t){var n=t.headers,r=localStorage.getItem("user-token");return{headers:Object(a.a)({},n,{authorization:r?"bearer ".concat(r):null})}})),zt=new Ot.a({uri:"/graphql"});xe=window.location.host.includes("localhost")||window.location.host.includes("192.168.1.")?new kt.a({uri:"ws://".concat(window.location.host,"/graphql"),options:{reconnect:!0}}):new kt.a({uri:"wss://".concat(window.location.host,"/graphql"),options:{reconnect:!0}});var Rt=Object(jt.a)((function(e){var t=e.query,n=Object(St.a)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),xe,xt.concat(zt)),It=new vt.a({cache:new yt.a,link:Rt,defaultOptions:{watchQuery:{fetchPolicy:"no-cache"},query:{fetchPolicy:"no-cache"},mutation:{fetchPolicy:"no-cache"}}}),$t=localStorage.getItem("user-token"),Nt=localStorage.getItem("logged-user"),Bt=localStorage.getItem("mode");$t&&Ft.dispatch(B($t)),Nt&&Ft.dispatch(Q(JSON.parse(Nt))),Bt?Ft.dispatch(gt(Bt)):Ft.dispatch(gt("light")),i.a.render(c.a.createElement(Ct.a,{client:It},c.a.createElement(T.a,{store:Ft},c.a.createElement(V.a,null,c.a.createElement(Et,null)))),document.getElementById("root"))}},[[137,1,2]]]);
//# sourceMappingURL=main.ea0a93ef.chunk.js.map