(this.webpackJsonpchatforum=this.webpackJsonpchatforum||[]).push([[0],{125:function(e,t,n){e.exports=n(147)},147:function(e,t,n){"use strict";n.r(t);var a=n(21),r=n(0),c=n.n(r),o=n(65),i=n.n(o),l=n(50),u=n(5),s=n(154),m=n(150),d=n(107),b=n(14),g=n(11);function f(){var e=Object(b.a)(["\nmutation deleteUserProfilePic {\n    deleteUserProfilePic {\n        username\n        imageUrl\n    }\n}\n"]);return f=function(){return e},e}function p(){var e=Object(b.a)(["\nmutation setUserProfilePic($imageUrl: String!) {\n    setUserProfilePic(imageUrl: $imageUrl)  {\n        username\n        imageUrl\n    }\n}\n"]);return p=function(){return e},e}function h(){var e=Object(b.a)(["\n    query user($username: String!) {\n        user(username: $username)  {\n            username\n            imageUrl\n        }\n    }\n"]);return h=function(){return e},e}function E(){var e=Object(b.a)(["\n    mutation createUser($username: String!, $password: String!) {\n        createUser(username: $username, password: $password)  {\n            value\n            user {\n                id\n                username\n                pinnedChats {\n                    title\n                }\n                admin\n            }\n        }\n    }\n"]);return E=function(){return e},e}function O(){var e=Object(b.a)(["\n    mutation login($username: String!, $password: String!) {\n        login(username: $username, password: $password)  {\n            value\n            user {\n                id\n                username\n                pinnedChats {\n                    title\n                }\n                admin\n            }\n        }\n    }\n"]);return O=function(){return e},e}var j,v=Object(g.a)(O()),C=Object(g.a)(E()),y=Object(g.a)(h()),w=Object(g.a)(p()),S=Object(g.a)(f()),k=n(9),U=n(157),T=n(33),L=n.n(T),F=n(48),D=function e(t,n){return function(){var a=Object(F.a)(L.a.mark((function a(r){return L.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:""!==t&&(clearTimeout(j),j=setTimeout((function(){r(e(""))}),1e3*n)),r({type:"SET NOTIFICATION",notification:t});case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET NOTIFICATION":return t.notification;default:return e}},$=function(){var e=Object(k.c)((function(e){return e.notification})),t={position:"absolute",width:"100%",textAlign:"center",zIndex:9999},n=Object(k.b)(),a=function(){n(D(""))};return""===e?c.a.createElement(c.a.Fragment,null):e.error?c.a.createElement(U.a,{style:t,variant:"danger",className:"errormessage",onClick:a},e.message):c.a.createElement(U.a,{style:t,variant:"success",className:"message",onClick:a},e.message)},R=function(e){return function(){var t=Object(F.a)(L.a.mark((function t(n){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SET_TOKEN",data:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TOKEN":return t.data;default:return e}},x=function(e){return function(){var t=Object(F.a)(L.a.mark((function t(n){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SET_USER",data:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.data;default:return e}},Q=n(18),N=function(){var e=Object(r.useState)(""),t=Object(u.a)(e,2),n=t[0],a=t[1],o=Object(r.useState)(""),i=Object(u.a)(o,2),b=i[0],g=i[1],f=Object(k.b)(),p=Object(l.g)(),h=Object(k.c)((function(e){return e.mode})),E=Object(d.a)(v,{onError:function(e){f(D({message:e.graphQLErrors[0].message,error:!0},10))}}),O=Object(u.a)(E,2),j=O[0],C=O[1];Object(r.useEffect)((function(){if(C.data){var e=C.data.login.value,t=C.data.login.user;f(R(e)),localStorage.setItem("user-token",e),p.push("/"),localStorage.setItem("logged-user",JSON.stringify(t)),f(x(t)),f(D({message:"Logged in",error:!1},10))}}),[C.data]);var y={borderColor:"grey"};return y.backgroundColor="light"===h?"white":"darkgray",c.a.createElement(c.a.Fragment,null,c.a.createElement($,null),c.a.createElement("div",{className:"container"},c.a.createElement("h2",null,"Login"),c.a.createElement(s.a,{onSubmit:function(e){e.preventDefault(),j({variables:{username:n,password:b}}),a(""),g("")}},c.a.createElement(s.a.Label,null,"username:"),c.a.createElement(s.a.Control,{type:"text",id:"username",style:y,value:n,name:"username",onChange:function(e){var t=e.target;return a(t.value)},required:!0}),c.a.createElement(s.a.Label,null,"password:"),c.a.createElement(s.a.Control,{type:"password",id:"password",style:y,value:b,name:"password",onChange:function(e){var t=e.target;return g(t.value)},required:!0}),c.a.createElement(m.a,{id:"submit",type:"submit"},"Login")," or ",c.a.createElement(Q.b,{to:"/signin"},"Sign in"))))},B=n(106),q=n(108);function V(){var e=Object(b.a)(["\n    mutation zeroReportChat($chatTitle: String!) {\n        zeroReportChat(chatTitle: $chatTitle)  {\n            title\n        }\n    }\n"]);return V=function(){return e},e}function A(){var e=Object(b.a)(["\n    mutation unreportChat($chatTitle: String!) {\n        unreportChat(chatTitle: $chatTitle)  {\n            title\n        }\n    }\n"]);return A=function(){return e},e}function Z(){var e=Object(b.a)(["\n    mutation reportChat($chatTitle: String!) {\n        reportChat(chatTitle: $chatTitle)  {\n            title\n        }\n    }\n"]);return Z=function(){return e},e}function _(){var e=Object(b.a)(["\n    mutation unpinChat($chatTitle: String!) {\n        unpinChat(chatTitle: $chatTitle)  {\n            title\n        }\n    }\n"]);return _=function(){return e},e}function J(){var e=Object(b.a)(["\n    mutation pinChat($chatTitle: String!) {\n        pinChat(chatTitle: $chatTitle)  {\n            title\n        }\n    }\n"]);return J=function(){return e},e}function W(){var e=Object(b.a)(["\n    subscription {\n        chatDeleted {\n            title\n            id\n        }\n    }\n"]);return W=function(){return e},e}function Y(){var e=Object(b.a)(["\n    subscription {\n        chatReported {\n            title\n            id\n            latestComment {\n                content\n                date\n                user {\n                    username\n                }\n            }\n            comments{\n                user { \n                    username\n                    imageUrl\n                }\n                date\n                content\n                imageUrl\n                hasVideo\n                reports\n                id\n            }\n            date\n            reports\n        }\n    }\n"]);return Y=function(){return e},e}function M(){var e=Object(b.a)(["\n    subscription {\n        chatAdded {\n            title\n            latestComment {\n                content\n                date\n                user {\n                    username\n                }\n            }\n            date\n            id\n            reports\n        }\n    }\n"]);return M=function(){return e},e}function K(){var e=Object(b.a)(["\n    query {\n        pinnedChats {\n            title\n        }\n    }\n"]);return K=function(){return e},e}function G(){var e=Object(b.a)(["\n    query chat($chatTitle: String!){\n        chat(chatTitle: $chatTitle) {\n            comments {\n                user { \n                    username\n                    imageUrl\n                }\n                date\n                content\n                imageUrl\n                hasVideo\n                reports\n                id\n            }\n            title\n            reports\n        }\n    }\n"]);return G=function(){return e},e}function H(){var e=Object(b.a)(["\n    query {\n        reportedChats {\n            title\n            latestComment{\n                content\n                date\n                user{\n                    username\n                }\n            }\n            id\n            date\n            reports\n        }\n    }\n"]);return H=function(){return e},e}function X(){var e=Object(b.a)(["\n    query {\n        chats {\n            title\n            latestComment{\n                content\n                date\n                user{\n                    username\n                }\n            }\n            id\n            date\n            reports\n        }\n    }\n"]);return X=function(){return e},e}function ee(){var e=Object(b.a)(["\n    mutation deleteChat($chatId: String!) {\n        deleteChat(chatId: $chatId)  {\n            title\n        }\n    }\n"]);return ee=function(){return e},e}function te(){var e=Object(b.a)(["\n    mutation createChat($chatTitle: String!) {\n        createChat(chatTitle: $chatTitle)  {\n            title\n        }\n    }\n"]);return te=function(){return e},e}var ne=Object(g.a)(te()),ae=Object(g.a)(ee()),re=Object(g.a)(X()),ce=Object(g.a)(H()),oe=Object(g.a)(G()),ie=Object(g.a)(K()),le=Object(g.a)(M()),ue=Object(g.a)(Y()),se=Object(g.a)(W()),me=Object(g.a)(J()),de=Object(g.a)(_()),be=Object(g.a)(Z()),ge=Object(g.a)(A()),fe=Object(g.a)(V());function pe(){var e=Object(b.a)(["\n    mutation zeroReportComment($commentId: String!) {\n        zeroReportComment(commentId: $commentId)  {\n            id\n        }\n    }\n"]);return pe=function(){return e},e}function he(){var e=Object(b.a)(["\n    mutation unreportComment($commentId: String!) {\n        unreportComment(commentId: $commentId)  {\n            id\n        }\n    }\n"]);return he=function(){return e},e}function Ee(){var e=Object(b.a)(["\n    mutation reportComment($commentId: String!) {\n        reportComment(commentId: $commentId)  {\n            id\n        }\n    }\n"]);return Ee=function(){return e},e}function Oe(){var e=Object(b.a)(["\n    subscription {\n        commentReported {\n            content\n            id\n            imageUrl\n            hasVideo\n            reports\n        }\n    }\n"]);return Oe=function(){return e},e}function je(){var e=Object(b.a)(["\n    subscription {\n        commentEdited {\n            content\n            id\n            imageUrl\n            hasVideo\n            reports\n        }\n    }\n"]);return je=function(){return e},e}function ve(){var e=Object(b.a)(["\n    mutation editComment($commentId: String!, $content: String!, $imageUrl: String) {\n        editComment(\n            commentId: $commentId\n            content: $content\n            imageUrl: $imageUrl\n        ){\n            content\n            id\n        }\n    }\n"]);return ve=function(){return e},e}function Ce(){var e=Object(b.a)(["\n    subscription {\n        commentDeleted {\n            content\n            imageUrl\n            reports\n            id\n        }\n    }\n"]);return Ce=function(){return e},e}function ye(){var e=Object(b.a)(["\n    mutation deleteComment($commentId: String!) {\n        deleteComment(commentId: $commentId)  {\n            content\n            id\n        }\n    }\n"]);return ye=function(){return e},e}function we(){var e=Object(b.a)(["\n    subscription {\n        commentAdded {\n            comment {\n                user { \n                    username\n                    imageUrl\n                }\n                date\n                content\n                imageUrl\n                hasVideo\n                reports\n                id\n            }\n            chatTitle\n        }\n    }\n"]);return we=function(){return e},e}function Se(){var e=Object(b.a)(["\n    query {\n        reportedComments {\n            content\n            date\n            imageUrl\n            hasVideo\n            id\n            user{\n                username\n                imageUrl\n            }\n            reports\n        }\n    }\n"]);return Se=function(){return e},e}function ke(){var e=Object(b.a)(["\n    mutation createComment($chatTitle: String!, $content: String!, $imageUrl: String) {\n        createComment(chatTitle: $chatTitle, content: $content, imageUrl: $imageUrl)  {\n            content\n            date\n            imageUrl\n            hasVideo\n            reports\n            id\n            user{\n                username\n                imageUrl\n            }\n        }\n    }\n"]);return ke=function(){return e},e}var Ue,Te=Object(g.a)(ke()),Le=Object(g.a)(Se()),Fe=Object(g.a)(we()),De=Object(g.a)(ye()),Ie=Object(g.a)(Ce()),$e=Object(g.a)(ve()),Re=Object(g.a)(je()),ze=Object(g.a)(Oe()),xe=Object(g.a)(Ee()),Pe=Object(g.a)(he()),Qe=Object(g.a)(pe()),Ne=function(e){var t=e.chat,n=e.isPinned,a=e.submitPin,o=e.submitUnpin,i=Object(k.b)(),l=Object(k.c)((function(e){return e.user})),s="No comments yet.",b={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},g=new Date(t.date).toLocaleTimeString([],b);t.latestComment&&(s=t.latestComment.content.length>30?"".concat(t.latestComment.content.substring(0,30),"... -").concat(t.latestComment.user.username):"".concat(t.latestComment.content," -").concat(t.latestComment.user.username),g=new Date(t.latestComment.date).toLocaleTimeString([],b));var f=Object(d.a)(ae,{onError:function(e){i(D({message:e.graphQLErrors[0].message,error:!0},10))}}),p=Object(u.a)(f,2),h=p[0],E=(p[1],Object(d.a)(be,{onError:function(e){i(D({message:e.graphQLErrors[0].message,error:!0},10))}})),O=Object(u.a)(E,2),j=O[0],v=O[1];Object(r.useEffect)((function(){v.data&&i(D({message:"Chat reported",error:!1},10))}),[v.data]);var C=Object(d.a)(ge,{onError:function(e){i(D({message:e.graphQLErrors[0].message,error:!0},10))}}),y=Object(u.a)(C,2),w=y[0],S=y[1];Object(r.useEffect)((function(){S.data&&i(D({message:"Chat unreported",error:!1},10))}),[S.data]);var U=Object(d.a)(fe,{onError:function(e){i(D({message:e.graphQLErrors[0].message,error:!0},10))}}),T=Object(u.a)(U,2),L=T[0],F=T[1];Object(r.useEffect)((function(){F.loading&&F.called&&i(D({message:"Chat's reports zeroed",error:!1},10))}),[F]);return c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",padding:"10px",marginBottom:"10px"}},c.a.createElement("div",null,c.a.createElement(Q.b,{to:"/chats/".concat(t.title)},t.title),l.admin?c.a.createElement(c.a.Fragment,null," Reports: ",t.reports.length):c.a.createElement(c.a.Fragment,null)),c.a.createElement("div",null,s),c.a.createElement("div",null,g,"\xa0",n?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return o(t)}},"Unpin"):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return a(t)}},"Pin"),l.admin?c.a.createElement(c.a.Fragment,null,t.reports.length>0?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Zero chat's reports?")&&L({variables:{chatTitle:t.title}})}},"Zero reports"):c.a.createElement(c.a.Fragment,null),c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Delete chat?")&&h({variables:{chatId:t.id}})}},"Delete")):c.a.createElement(c.a.Fragment,null,t.reports.includes(l.id)?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Unreport chat?")&&w({variables:{chatTitle:t.title}})}},"Unreport"):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Report chat?")&&j({variables:{chatTitle:t.title}})}},"Report"))))},Be=n(151),qe=n(113),Ve=function(){var e=Object(r.useState)(""),t=Object(u.a)(e,2),n=t[0],a=t[1],o=Object(k.b)(),i=Object(k.c)((function(e){return e.mode})),b=Object(l.g)(),g=Object(d.a)(ne,{onError:function(e){o(D({message:e.graphQLErrors[0].message,error:!0},10))}}),f=Object(u.a)(g,2),p=f[0],h=f[1];Object(r.useEffect)((function(){h.data&&(o(D({message:"New chat created",error:!1},10)),b.push("/chats/".concat(h.data.createChat.title)))}),[h.data]);var E={resize:"none",borderColor:"grey"};return E.backgroundColor="light"===i?"white":"darkgray",c.a.createElement(s.a,{onSubmit:function(e){e.preventDefault(),p({variables:{chatTitle:n}}),a("")}},c.a.createElement(Be.a,{size:"lg"},c.a.createElement(qe.a,{md:"10",style:{paddingRight:"0",paddingLeft:"0"}},c.a.createElement(s.a.Control,{as:"textarea",rows:"1",style:E,id:"content",value:n,name:"content",onChange:function(e){var t=e.target;return a(t.value)},placeholder:"Title...",required:!0,block:"true"})),c.a.createElement(qe.a,{md:"2",style:{paddingRight:"0",paddingLeft:"0"}},c.a.createElement(m.a,{style:{height:"100%"},id:"submit",type:"submit",size:"lg",block:"true"},"Start new chat"))))},Ae=function(){var e=Object(k.b)(),t=Object(k.c)((function(e){return e.mode})),n=Object(r.useState)([]),o=Object(u.a)(n,2),i=o[0],l=o[1],s=Object(B.a)(re),m=Object(u.a)(s,2),b=m[0],g=m[1],f=Object(B.a)(ie),p=Object(u.a)(f,2),h=p[0],E=p[1],O=Object(r.useState)([]),j=Object(u.a)(O,2),v=j[0],C=j[1],y=Object(r.useState)(""),w=Object(u.a)(y,2),S=w[0],U=w[1],T=Object(r.useState)(),L=Object(u.a)(T,2),F=L[0],I=L[1],$=Object(r.useCallback)((function(e,t){if(!F)return 0;if(F.includes(e.title)&&!F.includes(t.title))return-1;if(!F.includes(e.title)&&F.includes(t.title))return 1;var n=e.date;e.latestComment&&(n=e.latestComment.date);var a=t.date;return t.latestComment&&(a=t.latestComment.date),a-n}),[F]);Object(r.useEffect)((function(){b(),h()}),[]),Object(r.useEffect)((function(){g.data&&(l(g.data.chats.slice(0).sort($)),C(i))}),[g.data]),Object(r.useEffect)((function(){E.data&&I(E.data.pinnedChats.map((function(e){return e.title})))}),[E.data]),Object(q.a)(le,{onSubscriptionData:function(e){var t=e.subscriptionData.data.chatAdded,n=i.concat(t);n.sort($),l(n)}}),Object(q.a)(Fe,{onSubscriptionData:function(e){var t=e.subscriptionData,n=t.data.commentAdded.comment,r=t.data.commentAdded.chatTitle,c=i.map((function(e){return e.title===r?Object(a.a)({},e,{latestComment:n}):e}));c.sort($),l(c)}}),Object(q.a)(ue,{onSubscriptionData:function(e){var t=e.subscriptionData.data.chatReported,n=i.map((function(e){return e.title===t.title?Object(a.a)({},e,{reports:t.reports}):e}));n.sort($),l(n)}}),Object(r.useEffect)((function(){C(""===S?i.slice(0).sort($):i.filter((function(e){return e.title.toLowerCase().startsWith(S.toLowerCase())})).sort($))}),[S,i,$]);var R=Object(d.a)(me,{onError:function(t){e(D({message:t.graphQLErrors[0].message,error:!0},10))}}),z=Object(u.a)(R,2),x=z[0],P=z[1],Q=Object(d.a)(de,{onError:function(t){e(D({message:t.graphQLErrors[0].message,error:!0},10))}}),N=Object(u.a)(Q,2),V=N[0],A=N[1],Z=function(e){window.confirm("Pin chat?")&&x({variables:{chatTitle:e.title}})};Object(r.useEffect)((function(){P.data&&(I(F.concat(P.data.pinChat.title)),e(D({message:"Chat pinned",error:!1},10)))}),[P.data]);var _=function(e){window.confirm("Unpin chat?")&&V({variables:{chatTitle:e.title}})};Object(r.useEffect)((function(){A.data&&(I(F.filter((function(e){return e!==A.data.unpinChat.title}))),e(D({message:"Chat unpinned",error:!1},10)))}),[A.data]),Object(q.a)(se,{onSubscriptionData:function(e){var t=e.subscriptionData.data.chatDeleted;l(i.filter((function(e){return e.id!==t.id})))}});var J={width:"100%",paddingBottom:"0",borderColor:"grey"};J.backgroundColor="light"===t?"white":"darkgray";var W={paddingRight:"0",paddingLeft:"0"};return c.a.createElement("div",{style:{height:"100%"}},c.a.createElement(Be.a,null,c.a.createElement(qe.a,{md:"8",style:W},c.a.createElement("h2",{style:{display:"inline-block",marginBottom:"0"}},"Chats")),c.a.createElement(qe.a,{md:"4",style:W},c.a.createElement("input",{style:J,type:"text",value:S,onChange:function(e){var t=e.target;return U(t.value)},placeholder:"Filter chats by title..."}))),c.a.createElement(Be.a,null,c.a.createElement(qe.a,{style:W},c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",borderColor:"grey",padding:"10px",marginBottom:"0",overflowY:"scroll",height:"77.5vh"}},F?c.a.createElement(c.a.Fragment,null,v.map((function(e){return c.a.createElement(Ne,{key:e.id,chat:e,submitPin:Z,submitUnpin:_,isPinned:F.includes(e.title)})}))):c.a.createElement("div",null,"Loading")))),c.a.createElement(Ve,null))},Ze=function(){var e=Object(k.b)(),t=Object(k.c)((function(e){return e.mode})),n=Object(k.c)((function(e){return e.user})),o=Object(l.g)(),i=Object(r.useState)([]),s=Object(u.a)(i,2),m=s[0],b=s[1],g=Object(B.a)(ce),f=Object(u.a)(g,2),p=f[0],h=f[1],E=Object(B.a)(ie),O=Object(u.a)(E,2),j=O[0],v=O[1],C=Object(r.useState)([]),y=Object(u.a)(C,2),w=y[0],S=y[1],U=Object(r.useState)(""),T=Object(u.a)(U,2),L=T[0],F=T[1],I=Object(r.useState)(),$=Object(u.a)(I,2),R=$[0],z=$[1],x=Object(r.useCallback)((function(e,t){if(!R)return 0;if(R.includes(e.title)&&!R.includes(t.title))return-1;if(!R.includes(e.title)&&R.includes(t.title))return 1;if(e.reports.length!==t.reports.length)return t.reports.length-e.reports.length;var n=e.date;e.latestComment&&(n=e.latestComment.date);var a=t.date;return t.latestComment&&(a=t.latestComment.date),a-n}),[R]);Object(r.useEffect)((function(){n.admin||o.push("/error/Not authorized"),p(),j()}),[]),Object(r.useEffect)((function(){h.data&&(b(h.data.reportedChats.slice(0).sort(x)),S(m))}),[h.data]),Object(r.useEffect)((function(){v.data&&z(v.data.pinnedChats.map((function(e){return e.title})))}),[v.data]),Object(q.a)(le,{onSubscriptionData:function(e){var t=e.subscriptionData.data.chatAdded,n=m.concat(t);n.sort(x),b(n)}}),Object(q.a)(Fe,{onSubscriptionData:function(e){var t=e.subscriptionData,n=t.data.commentAdded.comment,r=t.data.commentAdded.chatTitle,c=m.map((function(e){return e.title===r?Object(a.a)({},e,{latestComment:n}):e}));c.sort(x),b(c)}}),Object(q.a)(ue,{onSubscriptionData:function(e){var t=e.subscriptionData.data.chatReported,n=[];(n=m.map((function(e){return e.title})).includes(t.title)?m.map((function(e){return e.title===t.title?Object(a.a)({},e,{reports:t.reports}):e})):m.concat(t)).sort(x),b(n.filter((function(e){return e.reports.length>0})))}}),Object(r.useEffect)((function(){S(""===L?m.slice(0).sort(x):m.filter((function(e){return e.title.toLowerCase().startsWith(L.toLowerCase())})).sort(x))}),[L,m,x]);var P=Object(d.a)(me,{onError:function(t){e(D({message:t.graphQLErrors[0].message,error:!0},10))}}),Q=Object(u.a)(P,2),N=Q[0],V=Q[1],A=Object(d.a)(de,{onError:function(t){e(D({message:t.graphQLErrors[0].message,error:!0},10))}}),Z=Object(u.a)(A,2),_=Z[0],J=Z[1],W=function(e){window.confirm("Pin chat?")&&N({variables:{chatTitle:e.title}})};Object(r.useEffect)((function(){V.data&&(z(R.concat(V.data.pinChat.title)),e(D({message:"Chat pinned",error:!1},10)))}),[V.data]);var Y=function(e){window.confirm("Unpin chat?")&&_({variables:{chatTitle:e.title}})};Object(r.useEffect)((function(){J.data&&(z(R.filter((function(e){return e!==J.data.unpinChat.title}))),e(D({message:"Chat unpinned",error:!1},10)))}),[J.data]),Object(q.a)(se,{onSubscriptionData:function(e){var t=e.subscriptionData.data.chatDeleted;b(m.filter((function(e){return e.id!==t.id})))}});var M={width:"100%",paddingBottom:"0",borderColor:"grey"};M.backgroundColor="light"===t?"white":"darkgray";var K={paddingRight:"0",paddingLeft:"0"};return c.a.createElement("div",{style:{height:"100%"}},c.a.createElement(Be.a,null,c.a.createElement(qe.a,{md:"8",style:K},c.a.createElement("h2",{style:{display:"inline-block",marginBottom:"0"}},"Reported chats")),c.a.createElement(qe.a,{md:"4",style:K},c.a.createElement("input",{style:M,type:"text",value:L,onChange:function(e){var t=e.target;return F(t.value)},placeholder:"Filter chats by title..."}))),c.a.createElement(Be.a,null,c.a.createElement(qe.a,{style:K},c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",borderColor:"grey",padding:"10px",marginBottom:"0",overflowY:"scroll",height:"77.5vh"}},R?c.a.createElement(c.a.Fragment,null,w.map((function(e){return c.a.createElement(Ne,{key:e.id,chat:e,submitPin:W,submitUnpin:Y,isPinned:R.includes(e.title)})}))):c.a.createElement("div",null,"Loading")))))},_e=n(152),Je=function(e){var t=e.comment,n=Object(k.b)(),a=Object(k.c)((function(e){return e.user})),o=Object(k.c)((function(e){return e.mode})),i=Object(r.useState)(t.content),l=Object(u.a)(i,2),s=l[0],b=l[1],g=Object(r.useState)(!1),f=Object(u.a)(g,2),p=f[0],h=f[1],E=Object(r.useState)(t.imageUrl),O=Object(u.a)(E,2),j=O[0],v=O[1];Object(r.useEffect)((function(){t.imageUrl||v("")}),[]);var C=Object(d.a)(De,{onError:function(e){n(D({message:e.graphQLErrors[0].message,error:!0},10))}}),y=Object(u.a)(C,2),w=y[0],S=y[1],U=Object(d.a)($e,{onError:function(e){n(D({message:e.graphQLErrors[0].message,error:!0},10))}}),T=Object(u.a)(U,2),L=T[0],F=T[1];Object(r.useEffect)((function(){S.called&&S.loading&&n(D({message:"Comment deleted",error:!1},10))}),[S]);var I=c.a.createElement(c.a.Fragment,null);t.imageUrl&&""!==t.imageUrl&&(I=t.hasVideo?c.a.createElement(c.a.Fragment,null,c.a.createElement("iframe",{width:"420",height:"315",frameBorder:"0",allowFullScreen:!0,title:"video",src:t.imageUrl}),c.a.createElement("br",null)):c.a.createElement(c.a.Fragment,null,c.a.createElement(_e.a,{src:t.imageUrl,fluid:!0}),c.a.createElement("br",null)));var $=c.a.createElement(c.a.Fragment,null);t.user.imageUrl&&($=c.a.createElement(c.a.Fragment,null,c.a.createElement(_e.a,{style:{height:"10%",width:"10%"},src:t.user.imageUrl,fluid:!0})));Object(r.useEffect)((function(){F.data&&(h(!1),n(D({message:"Comment edited",error:!1},10)))}),[F.data]);Object(r.useEffect)((function(){b(t.content)}),[t]);var R=Object(d.a)(xe,{onError:function(e){n(D({message:e.graphQLErrors[0].message,error:!0},10))}}),z=Object(u.a)(R,2),x=z[0],P=z[1];Object(r.useEffect)((function(){P.data&&n(D({message:"Comment reported",error:!1},10))}),[P.data]);var N=Object(d.a)(Pe,{onError:function(e){n(D({message:e.graphQLErrors[0].message,error:!0},10))}}),B=Object(u.a)(N,2),q=B[0],V=B[1];Object(r.useEffect)((function(){V.data&&n(D({message:"Comment unreported",error:!1},10))}),[V.data]);var A=Object(d.a)(Qe,{onError:function(e){n(D({message:e.graphQLErrors[0].message,error:!0},10))}}),Z=Object(u.a)(A,2),_=Z[0],J=Z[1];Object(r.useEffect)((function(){J.called&&J.loading&&n(D({message:"Comment's reports zeroed",error:!1},10))}),[J]);var W={width:"100%",resize:"none",border:"none"},Y={borderColor:"grey",width:"100%"};"light"===o?(W.backgroundColor="white",Y.backgroundColor="white"):(W.backgroundColor="darkgray",Y.backgroundColor="darkgray");var M=new Date(t.date).toLocaleTimeString([],{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",padding:"10px",marginBottom:"10px"}},c.a.createElement("div",null,$," ",c.a.createElement(Q.b,{to:"/users/".concat(t.user.username)},t.user.username)," ",M,a.admin?c.a.createElement(c.a.Fragment,null," Reports: ",t.reports.length):c.a.createElement(c.a.Fragment,null)),c.a.createElement("textarea",{rows:"2",value:s,readOnly:!p,style:W,onChange:function(e){var t=e.target;return b(t.value)},block:"true"}),I,p?c.a.createElement(c.a.Fragment,null,c.a.createElement("input",{type:"text",style:Y,placeholder:"Image/video url...",value:j,onChange:function(e){var t=e.target;return v(t.value)},block:"true"}),c.a.createElement("br",null)):c.a.createElement(c.a.Fragment,null),a.username===t.user.username||a.admin||"Comment deleted"===t.content?c.a.createElement(c.a.Fragment,null):c.a.createElement(c.a.Fragment,null,t.reports.includes(a.id)?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Unreport comment?")&&q({variables:{commentId:t.id}})}},"Unreport"):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Report comment?")&&x({variables:{commentId:t.id}})}},"Report")),a.admin?c.a.createElement(c.a.Fragment,null,t.reports.length>0?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Zero comment's reports?")&&_({variables:{commentId:t.id}})}},"Zero reports"):c.a.createElement(c.a.Fragment,null)):c.a.createElement(c.a.Fragment,null),a.username!==t.user.username&&!a.admin||"Comment deleted"===t.content?c.a.createElement(c.a.Fragment,null):c.a.createElement(c.a.Fragment,null,c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Delete comment?")&&w({variables:{commentId:t.id}})}},"Delete comment"),p?c.a.createElement(c.a.Fragment,null,c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){h(!1),v(t.imageUrl),b(t.content)}},"Stop editing"),c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Edit comment?")&&L({variables:{commentId:t.id,content:s,imageUrl:j}})}},"Submit edit")):c.a.createElement(c.a.Fragment,null,a.username===t.user.username?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){h(!0),t.content.endsWith(" -edited")&&b(t.content.substring(0,t.content.length-8))}},"Start editing"):c.a.createElement(c.a.Fragment,null))))},We=function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),n=t[0],o=t[1],i=Object(l.g)(),s=Object(k.c)((function(e){return e.mode})),m=Object(k.c)((function(e){return e.user})),d=Object(r.useState)([]),b=Object(u.a)(d,2),g=b[0],f=b[1],p=Object(r.useState)(""),h=Object(u.a)(p,2),E=h[0],O=h[1],j=Object(B.a)(Le),v=Object(u.a)(j,2),C=v[0],y=v[1],w=Object(r.useRef)(null),S=function(e,t){return e.reports.length!==t.reports.length?t.reports.length-e.reports.length:e.date-t.date};Object(r.useEffect)((function(){m.admin||i.push("/error/Not authorized"),C()}),[]),Object(r.useEffect)((function(){y.data&&o(y.data.reportedComments.sort(S))}),[y]),Object(r.useEffect)((function(){w.current.scrollIntoView({behavior:"smooth"})}),[n,g]),Object(q.a)(Ie,{onSubscriptionData:function(e){var t=e.subscriptionData.data.commentDeleted;o(n.filter((function(e){return e.id!==t.id})))}}),Object(q.a)(Re,{onSubscriptionData:function(e){var t=e.subscriptionData.data.commentEdited;o(n.map((function(e){return e.id===t.id?Object(a.a)({},e,{content:t.content,imageUrl:t.imageUrl,hasVideo:t.hasVideo}):e})))}}),Object(r.useEffect)((function(){f(""===E?n:n.filter((function(e){return e.content.toLowerCase().includes(E.toLowerCase())})))}),[E,n]),Object(q.a)(ze,{onSubscriptionData:function(e){var t=e.subscriptionData.data.commentReported,r=[];(r=n.map((function(e){return e.id})).includes(t.id)?n.map((function(e){return e.id===t.id?Object(a.a)({},e,{reports:t.reports}):e})):n.concat(t)).sort(S),o(r.filter((function(e){return e.reports.length>0})))}});var U={width:"100%",paddingBottom:"0",borderColor:"grey"};U.backgroundColor="light"===s?"white":"darkgray";var T={paddingRight:"0",paddingLeft:"0"};return c.a.createElement(c.a.Fragment,null,c.a.createElement(Be.a,null,c.a.createElement(qe.a,{md:"8",style:T},c.a.createElement("h2",{style:{display:"inline-block",marginBottom:"0"}},"Reported comments")),c.a.createElement(qe.a,{md:"4",style:T},c.a.createElement("input",{style:U,type:"text",value:E,onChange:function(e){var t=e.target;return O(t.value)},placeholder:"Filter comments by content..."}))),c.a.createElement(Be.a,null,c.a.createElement(qe.a,{style:T},c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",borderColor:"grey",padding:"10px",marginBottom:"0",overflowY:"scroll",height:"70vh",width:"100%"}},0===n.length?c.a.createElement("div",null,"No reported comments"):g.map((function(e){return c.a.createElement(Je,{key:e.id,comment:e})})),c.a.createElement("div",{ref:w})))))},Ye=function(e){var t=e.title,n=Object(r.useState)(""),a=Object(u.a)(n,2),o=a[0],i=a[1],l=Object(r.useState)(""),b=Object(u.a)(l,2),g=b[0],f=b[1],p=Object(k.b)(),h=Object(k.c)((function(e){return e.mode})),E=Object(d.a)(Te,{onCompleted:function(){i(""),f("")},onError:function(e){p(D({message:e.graphQLErrors[0].message,error:!0},10))}}),O=Object(u.a)(E,2),j=O[0],v=(O[1],{resize:"none",borderColor:"grey"}),C={borderColor:"grey"};return"light"===h?(v.backgroundColor="white",C.backgroundColor="white"):(v.backgroundColor="darkgray",C.backgroundColor="darkgray"),c.a.createElement(s.a,{onSubmit:function(e){e.preventDefault(),j({variables:{chatTitle:t,content:o,imageUrl:g}})}},c.a.createElement(Be.a,{size:"lg"},c.a.createElement(qe.a,{md:"10",style:{paddingRight:"0",paddingLeft:"0"}},c.a.createElement(s.a.Control,{as:"textarea",rows:"2",style:v,id:"content",value:o,name:"content",onChange:function(e){var t=e.target;return i(t.value)},placeholder:"New comment...",required:!0,block:"true"}),c.a.createElement(s.a.Control,{style:C,size:"sm",type:"text",placeholder:"Image/video url...",value:g,name:"imageUrl",id:"imageUrl",onChange:function(e){var t=e.target;return f(t.value)},block:"true"})),c.a.createElement(qe.a,{md:"2",style:{paddingLeft:"0",paddingRight:"0"}},c.a.createElement(m.a,{style:{height:"100%"},id:"submit",type:"submit",size:"lg",block:!0},"Send"))))},Me=function(e){var t=e.title,n=Object(r.useState)(null),o=Object(u.a)(n,2),i=o[0],s=o[1],b=Object(r.useState)([]),g=Object(u.a)(b,2),f=g[0],p=g[1],h=Object(l.g)(),E=Object(k.b)(),O=Object(k.c)((function(e){return e.mode})),j=Object(k.c)((function(e){return e.user})),v=Object(r.useState)([]),C=Object(u.a)(v,2),y=C[0],w=C[1],S=Object(r.useState)(""),U=Object(u.a)(S,2),T=U[0],L=U[1],F=Object(B.a)(oe),I=Object(u.a)(F,2),$=I[0],R=I[1],z=Object(B.a)(ie),x=Object(u.a)(z,2),P=x[0],Q=x[1],N=Object(r.useState)(),V=Object(u.a)(N,2),A=V[0],Z=V[1],_=Object(r.useRef)(null);Object(r.useEffect)((function(){$({variables:{chatTitle:t}}),P()}),[]),Object(r.useEffect)((function(){$({variables:{chatTitle:t}}),P()}),[t]),Object(r.useEffect)((function(){R.data?(p(R.data.chat.comments.sort((function(e,t){return e.date-t.date}))),s(R.data.chat)):R.called&&!R.loading&&h.push("/error/Chat does not exist")}),[R]),Object(r.useEffect)((function(){Q.data&&Z(Q.data.pinnedChats.map((function(e){return e.title})))}),[Q.data]),Object(r.useEffect)((function(){_.current.scrollIntoView({behavior:"smooth"})}),[f,y]),Object(q.a)(Fe,{onSubscriptionData:function(e){var n=e.subscriptionData,a=n.data.commentAdded.comment;if(n.data.commentAdded.chatTitle===t){var r=f.concat(a);r.sort((function(e,t){return e.date-t.date})),p(r)}}}),Object(q.a)(Ie,{onSubscriptionData:function(e){var t=e.subscriptionData.data.commentDeleted;p(f.map((function(e){return e.id===t.id?Object(a.a)({},e,{content:t.content,imageUrl:t.imageUrl,reports:t.reports}):e})))}}),Object(q.a)(Re,{onSubscriptionData:function(e){var t=e.subscriptionData.data.commentEdited;p(f.map((function(e){return e.id===t.id?Object(a.a)({},e,{content:t.content,imageUrl:t.imageUrl,hasVideo:t.hasVideo}):e})))}}),Object(r.useEffect)((function(){w(""===T?f:f.filter((function(e){return e.content.toLowerCase().includes(T.toLowerCase())})))}),[T,f]);var J=Object(d.a)(be,{onError:function(e){E(D({message:e.graphQLErrors[0].message,error:!0},10))}}),W=Object(u.a)(J,2),Y=W[0],M=W[1];Object(r.useEffect)((function(){M.data&&E(D({message:"Chat reported",error:!1},10))}),[M.data]);var K=Object(d.a)(ge,{onError:function(e){E(D({message:e.graphQLErrors[0].message,error:!0},10))}}),G=Object(u.a)(K,2),H=G[0],X=G[1];Object(r.useEffect)((function(){X.data&&E(D({message:"Chat unreported",error:!1},10))}),[X.data]);var ee=Object(d.a)(fe,{onError:function(e){E(D({message:e.graphQLErrors[0].message,error:!0},10))}}),te=Object(u.a)(ee,2),ne=te[0],ae=te[1];Object(r.useEffect)((function(){ae.data&&E(D({message:"Chat's reports zeroed",error:!1},10))}),[ae.data]),Object(q.a)(ue,{onSubscriptionData:function(e){var n=e.subscriptionData.data.chatReported;n.title===t&&s(n)}});var re=Object(d.a)(me,{onError:function(e){E(D({message:e.graphQLErrors[0].message,error:!0},10))}}),ce=Object(u.a)(re,2),le=ce[0],se=ce[1],pe=Object(d.a)(de,{onError:function(e){E(D({message:e.graphQLErrors[0].message,error:!0},10))}}),he=Object(u.a)(pe,2),Ee=he[0],Oe=he[1];Object(r.useEffect)((function(){se.data&&(Z(A.concat(se.data.pinChat.title)),E(D({message:"Chat pinned",error:!1},10)))}),[se.data]);Object(r.useEffect)((function(){Oe.data&&(Z(A.filter((function(e){return e!==Oe.data.unpinChat.title}))),E(D({message:"Chat unpinned",error:!1},10)))}),[Oe.data]),Object(q.a)(ze,{onSubscriptionData:function(e){var t=e.subscriptionData.data.commentReported,n=f.map((function(e){return e.id===t.id?Object(a.a)({},e,{reports:t.reports}):e}));p(n)}});var je={width:"100%",paddingBottom:"0",borderColor:"grey",paddingRight:"0",paddingLeft:"0"};je.backgroundColor="light"===O?"white":"darkgray";var ve={paddingRight:"0",paddingLeft:"0"};return c.a.createElement(c.a.Fragment,null,c.a.createElement(Be.a,null,c.a.createElement(qe.a,{md:"8",style:ve},t.startsWith("userChat")?c.a.createElement("h2",{style:{display:"inline-block",marginBottom:"0"}},"".concat(t.substring(8),"'s chat")):c.a.createElement("h2",{style:{display:"inline-block",marginBottom:"0"}},t,"\xa0",A&&A.includes(t)?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Unpin chat?")&&Ee({variables:{chatTitle:t}})}},"Unpin"):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Pin chat?")&&le({variables:{chatTitle:t}})}},"Pin"),j.admin?c.a.createElement(c.a.Fragment,null,i&&i.reports.length>0?c.a.createElement(c.a.Fragment,null,c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Zero chat's reports?")&&ne({variables:{chatTitle:t}})}},"Zero reports")," ",c.a.createElement("span",{style:{fontSize:"1rem"}}," Reports: ",i.reports.length)):c.a.createElement(c.a.Fragment,null)):c.a.createElement(c.a.Fragment,null,i&&i.reports&&i.reports.includes(j.id)?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Unreport chat?")&&H({variables:{chatTitle:t}})}},"Unreport"):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Report chat?")&&Y({variables:{chatTitle:t}})}},"Report")))),c.a.createElement(qe.a,{md:"4",style:ve},c.a.createElement("input",{style:je,type:"text",value:T,onChange:function(e){var t=e.target;return L(t.value)},placeholder:"Filter comments by content..."}))),c.a.createElement(Be.a,null,c.a.createElement(qe.a,{style:ve},c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",borderColor:"grey",padding:"10px",marginBottom:"0",overflowY:"scroll",height:"70vh",width:"100%"}},0===f.length?c.a.createElement("div",null,"No comments yet"):y.map((function(e){return c.a.createElement(Je,{key:e.id,comment:e})})),c.a.createElement("div",{ref:_})))),c.a.createElement(Ye,{title:t}))},Ke=function(){var e=Object(l.h)("/chats/:title"),t=e?e.params.title:null;return c.a.createElement("div",null,c.a.createElement(Me,{title:t}))},Ge=function(){var e=Object(k.b)(),t=Object(l.g)(),n=Object(k.c)((function(e){return e.user})),o=Object(l.h)("/users/:username"),i=Object(r.useState)(null),s=Object(u.a)(i,2),b=s[0],g=s[1],f=Object(r.useState)(""),p=Object(u.a)(f,2),h=p[0],E=p[1],O=Object(r.useState)(!1),j=Object(u.a)(O,2),v=j[0],C=j[1],U=o?o.params.username:null,T=Object(B.a)(y),L=Object(u.a)(T,2),F=L[0],I=L[1],$=Object(r.useState)(c.a.createElement(c.a.Fragment,null)),R=Object(u.a)($,2),z=R[0],x=R[1];Object(r.useEffect)((function(){F({variables:{username:U}})}),[U]),Object(r.useEffect)((function(){I.data?g(I.data.user):I.called&&!I.loading&&t.push("/error/User does not exist")}),[I]);var P=Object(d.a)(w,{onError:function(t){e(D({message:t.graphQLErrors[0].message,error:!0},10))}}),Q=Object(u.a)(P,2),N=Q[0],q=Q[1];Object(r.useEffect)((function(){q.data&&(e(D({message:"Profile picture set",error:!1},10)),g(Object(a.a)({},b,{imageUrl:q.data.setUserProfilePic.imageUrl})),E(""),C(!1),x(c.a.createElement(c.a.Fragment,null,c.a.createElement(_e.a,{style:{height:"10%",width:"10%"},src:q.data.setUserProfilePic.imageUrl,fluid:!0}),c.a.createElement("br",null))))}),[q.data]);var V=Object(d.a)(S,{onError:function(t){e(D({message:t.graphQLErrors[0].message,error:!0},10))}}),A=Object(u.a)(V,2),Z=A[0],_=A[1];Object(r.useEffect)((function(){_.data&&(e(D({message:"Profile picture deleted",error:!1},10)),g(Object(a.a)({},b,{imageUrl:null})),E(""),C(!1),x(c.a.createElement(c.a.Fragment,null)))}),[_.data]);return Object(r.useEffect)((function(){b&&b.imageUrl&&x(c.a.createElement(c.a.Fragment,null,c.a.createElement(_e.a,{style:{height:"100%",width:"100%"},src:b.imageUrl,fluid:!0}),c.a.createElement("br",null)))}),[b]),c.a.createElement(c.a.Fragment,null,b?c.a.createElement(Be.a,null,c.a.createElement(qe.a,{md:"3"},c.a.createElement(Be.a,null,c.a.createElement("div",null,z)),c.a.createElement(Be.a,null,c.a.createElement("h2",null,b.username)),c.a.createElement(Be.a,null,b.username===n.username?c.a.createElement(c.a.Fragment,null,v?c.a.createElement(c.a.Fragment,null,c.a.createElement(Be.a,null,c.a.createElement("input",{type:"text",placeholder:"Url of the image...",value:h,onChange:function(e){var t=e.target;return E(t.value)}})),c.a.createElement(Be.a,null,c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){C(!1),E("")}},"Back"),b.imageUrl?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Delete profile picture?")&&Z()}},"Delete image"):c.a.createElement(c.a.Fragment,null),c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Set profile picture?")&&N({variables:{imageUrl:h}})}},"Submit image"))):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return C(!0)}},"Set image")):c.a.createElement(c.a.Fragment,null))),c.a.createElement(qe.a,{md:"9"},c.a.createElement("div",null,c.a.createElement(Me,{title:"userChat".concat(U)})))):c.a.createElement(c.a.Fragment,null))},He=function(){var e=Object(l.h)("/error/:errormessage"),t=e?e.params.errormessage:null;return c.a.createElement("h2",null,t)},Xe=n(153),et=function(){return c.a.createElement(Xe.a,{style:{height:"100%"}},c.a.createElement(l.d,null,c.a.createElement(l.b,{path:"/error/:errormessage"},c.a.createElement(He,null)),c.a.createElement(l.b,{path:"/reported/chats"},c.a.createElement(Ze,null)),c.a.createElement(l.b,{path:"/reported/comments"},c.a.createElement(We,null)),c.a.createElement(l.b,{path:"/chats/:title"},c.a.createElement(Ke,null)),c.a.createElement(l.b,{path:"/chats"},c.a.createElement(Ae,null)),c.a.createElement(l.b,{path:"/users/:username"},c.a.createElement(Ge,null)),c.a.createElement(l.b,{path:"/"},c.a.createElement(l.a,{to:"/chats"}))))},tt=function(){var e=Object(r.useState)(""),t=Object(u.a)(e,2),n=t[0],a=t[1],o=Object(r.useState)(""),i=Object(u.a)(o,2),b=i[0],g=i[1],f=Object(k.b)(),p=Object(l.g)(),h=Object(k.c)((function(e){return e.mode})),E=Object(d.a)(C,{onError:function(e){f(D({message:e.graphQLErrors[0].message,error:!0},10))}}),O=Object(u.a)(E,2),j=O[0],v=O[1];Object(r.useEffect)((function(){if(v.data){var e=v.data.createUser.value,t=v.data.createUser.user;f(R(e)),localStorage.setItem("user-token",e),p.push("/"),localStorage.setItem("logged-user",JSON.stringify(t)),f(x(t)),f(D({message:"Signed in",error:!1},10))}}),[v.data]);var y={borderColor:"grey"};return y.backgroundColor="light"===h?"white":"darkgray",c.a.createElement(c.a.Fragment,null,c.a.createElement($,null),c.a.createElement("div",{className:"container"},c.a.createElement("h2",null,"Sign in"),c.a.createElement(s.a,{onSubmit:function(e){e.preventDefault(),j({variables:{username:n,password:b}}),a(""),g("")}},c.a.createElement(s.a.Label,null,"username:"),c.a.createElement(s.a.Control,{type:"text",id:"username",style:y,value:n,name:"username",onChange:function(e){var t=e.target;return a(t.value)},required:!0}),c.a.createElement(s.a.Label,null,"password:"),c.a.createElement(s.a.Control,{type:"password",id:"password",style:y,value:b,name:"password",onChange:function(e){var t=e.target;return g(t.value)},required:!0}),c.a.createElement(m.a,{id:"submit",type:"submit"},"Sign in")," or ",c.a.createElement(Q.b,{to:"/login"},"Login"))))},nt=n(156),at=n(155),rt=function(e){return function(){var t=Object(F.a)(L.a.mark((function t(n){return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SET_MODE",data:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},ct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MODE":return localStorage.setItem("mode",t.data),t.data;default:return e}},ot=function(){var e=Object(k.c)((function(e){return e.user})),t=Object(k.c)((function(e){return e.mode})),n=Object(k.b)(),a=Object(l.g)();return e?c.a.createElement(c.a.Fragment,null,c.a.createElement(nt.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark"},c.a.createElement(nt.a.Brand,{href:"",as:"span"},"ChatForum"),c.a.createElement(nt.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),c.a.createElement(nt.a.Collapse,{id:"responsive-navbar-nav"},c.a.createElement(at.a,{className:"mr-auto"},c.a.createElement(at.a.Link,{href:"#",as:"span"},c.a.createElement(m.a,{variant:"outline-info",onClick:function(){a.push("/chats")}},"Chats")),e.admin?c.a.createElement(c.a.Fragment,null,c.a.createElement(at.a.Link,{href:"#",as:"span"},c.a.createElement(m.a,{variant:"outline-info",onClick:function(){a.push("/reported/chats")}},"Reported chats")),c.a.createElement(at.a.Link,{href:"#",as:"span"},c.a.createElement(m.a,{variant:"outline-info",onClick:function(){a.push("/reported/comments")}},"Reported comments"))):c.a.createElement(c.a.Fragment,null),c.a.createElement(at.a.Link,{href:"#",as:"span"},"light"===t?c.a.createElement(m.a,{variant:"outline-info",onClick:function(){return n(rt("dark"))}},"Dark mode"):c.a.createElement(m.a,{variant:"outline-info",onClick:function(){return n(rt("light"))}},"Light mode")),c.a.createElement(at.a.Link,{href:"#",as:"span"},c.a.createElement("div",null,c.a.createElement(Q.b,{to:"/users/".concat(e.username)},e.username)," logged in ",c.a.createElement(m.a,{variant:"outline-info",onClick:function(){window.localStorage.removeItem("user-token"),window.localStorage.removeItem("logged-user"),n(x(null)),n(R("")),n(D({message:"Logged out",error:!1},5)),a.push("/login")}},"Logout")))))),c.a.createElement($,null)):c.a.createElement(c.a.Fragment,null,c.a.createElement(nt.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark"},c.a.createElement(nt.a.Brand,{href:"",as:"span"},"ChatForum"),c.a.createElement(nt.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),c.a.createElement(nt.a.Collapse,{id:"responsive-navbar-nav"},c.a.createElement(at.a,{className:"mr-auto"},c.a.createElement(at.a.Link,{href:"#",as:"span"},"light"===t?c.a.createElement(m.a,{variant:"outline-info",onClick:function(){return n(rt("dark"))}},"Dark mode"):c.a.createElement(m.a,{variant:"outline-info",onClick:function(){return n(rt("light"))}},"Light mode"))))),c.a.createElement($,null))},it=function(){var e=Object(k.c)((function(e){return e.token})),t=Object(k.c)((function(e){return e.mode}));return document.body.style.backgroundColor="light"===t?"white":"darkgray",c.a.createElement("div",{style:{width:"100%",height:"100%",left:0,top:0,zIndex:10}},c.a.createElement(ot,null),c.a.createElement(l.d,null,c.a.createElement(l.b,{path:"/signin"},e?c.a.createElement(l.a,{to:"/chats"}):c.a.createElement(tt,null)),c.a.createElement(l.b,{path:"/login"},e?c.a.createElement(l.a,{to:"/chats"}):c.a.createElement(N,null)),c.a.createElement(l.b,{path:"/"},e?c.a.createElement(c.a.Fragment,null,c.a.createElement(et,null)):c.a.createElement(l.a,{to:"/login"}))))},lt=n(59),ut=n(75),st=n(76),mt=n(77),dt=n(105),bt=n(120),gt=n(117),ft=n(99),pt=n(55),ht=n(118),Et=n(119),Ot=Object(pt.combineReducers)({notification:I,user:P,token:z,mode:ct}),jt=Object(pt.createStore)(Ot,Object(ht.composeWithDevTools)(Object(pt.applyMiddleware)(Et.a))),vt=Object(bt.a)((function(e,t){var n=t.headers,r=localStorage.getItem("user-token");return{headers:Object(a.a)({},n,{authorization:r?"bearer ".concat(r):null})}})),Ct=new lt.a({uri:"/graphql"});Ue=window.location.host.includes("localhost")?new ft.a({uri:"ws://".concat(window.location.host,"/graphql"),options:{reconnect:!0}}):new ft.a({uri:"wss://".concat(window.location.host,"/graphql"),options:{reconnect:!0}});var yt=Object(ut.a)((function(e){var t=e.query,n=Object(gt.a)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),Ue,vt.concat(Ct)),wt=new st.a({cache:new mt.a,link:yt,defaultOptions:{watchQuery:{fetchPolicy:"no-cache"},query:{fetchPolicy:"no-cache"},mutation:{fetchPolicy:"no-cache"}}}),St=localStorage.getItem("user-token"),kt=localStorage.getItem("logged-user"),Ut=localStorage.getItem("mode");St&&jt.dispatch(R(St)),kt&&jt.dispatch(x(JSON.parse(kt))),Ut?jt.dispatch(rt(Ut)):jt.dispatch(rt("light")),i.a.render(c.a.createElement(dt.a,{client:wt},c.a.createElement(k.a,{store:jt},c.a.createElement(Q.a,null,c.a.createElement(it,null)))),document.getElementById("root"))}},[[125,1,2]]]);
//# sourceMappingURL=main.9d9cb673.chunk.js.map