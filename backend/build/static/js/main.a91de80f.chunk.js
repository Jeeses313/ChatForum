(this.webpackJsonpchatforum=this.webpackJsonpchatforum||[]).push([[0],{125:function(e,t,n){e.exports=n(147)},147:function(e,t,n){"use strict";n.r(t);var a=n(38),r=n(0),c=n.n(r),i=n(64),o=n.n(i),l=n(49),u=n(9),s=n(153),m=n(150),d=n(107),b=n(17),f=n(12);function g(){var e=Object(b.a)(["\nmutation deleteUserProfilePic {\n    deleteUserProfilePic {\n        username\n        imageUrl\n    }\n}\n"]);return g=function(){return e},e}function E(){var e=Object(b.a)(["\nmutation setUserProfilePic($imageUrl: String!) {\n    setUserProfilePic(imageUrl: $imageUrl)  {\n        username\n        imageUrl\n    }\n}\n"]);return E=function(){return e},e}function h(){var e=Object(b.a)(["\n    query user($username: String!) {\n        user(username: $username)  {\n            username\n            imageUrl\n        }\n    }\n"]);return h=function(){return e},e}function p(){var e=Object(b.a)(["\n    mutation createUser($username: String!, $password: String!) {\n        createUser(username: $username, password: $password)  {\n            value\n            user {\n                username\n                pinnedChats {\n                    title\n                }\n                admin\n            }\n        }\n    }\n"]);return p=function(){return e},e}function O(){var e=Object(b.a)(["\n    mutation login($username: String!, $password: String!) {\n        login(username: $username, password: $password)  {\n            value\n            user {\n                username\n                pinnedChats {\n                    title\n                }\n                admin\n            }\n        }\n    }\n"]);return O=function(){return e},e}var j,v=Object(f.a)(O()),w=Object(f.a)(p()),y=Object(f.a)(h()),C=Object(f.a)(E()),S=Object(f.a)(g()),U=n(14),k=n(156),T=n(44),$=n.n(T),F=n(66),I=function e(t,n){return function(){var a=Object(F.a)($.a.mark((function a(r){return $.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:""!==t&&(clearTimeout(j),j=setTimeout((function(){r(e(""))}),1e3*n)),r({type:"SET NOTIFICATION",notification:t});case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET NOTIFICATION":return t.notification;default:return e}},x=function(){var e=Object(U.c)((function(e){return e.notification})),t={position:"absolute",width:"100%",textAlign:"center",zIndex:9999},n=Object(U.b)(),a=function(){n(I(""))};return""===e?c.a.createElement(c.a.Fragment,null):e.error?c.a.createElement(k.a,{style:t,variant:"danger",className:"errormessage",onClick:a},e.message):c.a.createElement(k.a,{style:t,variant:"success",className:"message",onClick:a},e.message)},L=function(e){return function(){var t=Object(F.a)($.a.mark((function t(n){return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SET_TOKEN",data:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TOKEN":return t.data;default:return e}},P=function(e){return function(){var t=Object(F.a)($.a.mark((function t(n){return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SET_USER",data:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.data;default:return e}},q=n(18),B=function(){var e=Object(r.useState)(""),t=Object(u.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)(""),o=Object(u.a)(i,2),b=o[0],f=o[1],g=Object(U.b)(),E=Object(l.g)(),h=Object(d.a)(v,{onError:function(e){g(I({message:e.graphQLErrors[0].message,error:!0},10))}}),p=Object(u.a)(h,2),O=p[0],j=p[1];Object(r.useEffect)((function(){if(j.data){var e=j.data.login.value,t=j.data.login.user;g(L(e)),localStorage.setItem("user-token",e),E.push("/"),localStorage.setItem("logged-user",JSON.stringify(t)),g(P(t)),g(I({message:"Logged in",error:!1},10))}}),[j.data]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(x,null),c.a.createElement("div",{className:"container"},c.a.createElement("h2",null,"Login"),c.a.createElement(s.a,{onSubmit:function(e){e.preventDefault(),O({variables:{username:n,password:b}}),a(""),f("")}},c.a.createElement(s.a.Label,null,"username:"),c.a.createElement(s.a.Control,{type:"text",id:"username",value:n,name:"username",onChange:function(e){var t=e.target;return a(t.value)},required:!0}),c.a.createElement(s.a.Label,null,"password:"),c.a.createElement(s.a.Control,{type:"password",id:"password",value:b,name:"password",onChange:function(e){var t=e.target;return f(t.value)},required:!0}),c.a.createElement(m.a,{id:"submit",type:"submit"},"login")," or ",c.a.createElement(q.b,{to:"/signin"},"sign in"))))},Q=n(155),A=n(154),R=function(){var e=Object(U.c)((function(e){return e.user})),t=Object(U.b)(),n=Object(l.g)();return c.a.createElement(c.a.Fragment,null,c.a.createElement(Q.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark"},c.a.createElement(Q.a.Brand,{href:"",as:"span"},"ChatForum"),c.a.createElement(Q.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),c.a.createElement(Q.a.Collapse,{id:"responsive-navbar-nav"},c.a.createElement(A.a,{className:"mr-auto"},c.a.createElement(A.a.Link,{href:"#",as:"span"},c.a.createElement(m.a,{variant:"outline-info",onClick:function(){n.push("/chats")}},"Chats")),c.a.createElement(A.a.Link,{href:"#",as:"span"},c.a.createElement("div",null,c.a.createElement(q.b,{to:"/users/".concat(e.username)},e.username)," logged in ",c.a.createElement(m.a,{variant:"outline-info",onClick:function(){window.localStorage.removeItem("user-token"),window.localStorage.removeItem("logged-user"),t(P(null)),t(L("")),t(I({message:"Logged out",error:!1},5)),n.push("/login")}},"logout")))))),c.a.createElement(x,null))},J=n(106),_=n(108);function W(){var e=Object(b.a)(["\n    mutation unpinChat($chatTitle: String!) {\n        unpinChat(chatTitle: $chatTitle)  {\n            title\n        }\n    }\n"]);return W=function(){return e},e}function K(){var e=Object(b.a)(["\n    mutation pinChat($chatTitle: String!) {\n        pinChat(chatTitle: $chatTitle)  {\n            title\n        }\n    }\n"]);return K=function(){return e},e}function Y(){var e=Object(b.a)(["\n    subscription {\n        chatDeleted {\n            title\n            id\n        }\n    }\n"]);return Y=function(){return e},e}function M(){var e=Object(b.a)(["\n    subscription {\n        chatAdded {\n            title\n            latestComment {\n                content\n                date\n                user {\n                    username\n                }\n            }\n            date\n        }\n    }\n"]);return M=function(){return e},e}function V(){var e=Object(b.a)(["\n    query {\n        pinnedChats {\n            title\n        }\n    }\n"]);return V=function(){return e},e}function G(){var e=Object(b.a)(["\n    query {\n        chats {\n            title\n            latestComment{\n                content\n                date\n                user{\n                    username\n                }\n            }\n            id\n            date\n        }\n    }\n"]);return G=function(){return e},e}function H(){var e=Object(b.a)(["\n    mutation deleteChat($chatId: String!) {\n        deleteChat(chatId: $chatId)  {\n            title\n        }\n    }\n"]);return H=function(){return e},e}function X(){var e=Object(b.a)(["\n    mutation createChat($chatTitle: String!) {\n        createChat(chatTitle: $chatTitle)  {\n            title\n        }\n    }\n"]);return X=function(){return e},e}var Z=Object(f.a)(X()),ee=Object(f.a)(H()),te=Object(f.a)(G()),ne=Object(f.a)(V()),ae=Object(f.a)(M()),re=Object(f.a)(Y()),ce=Object(f.a)(K()),ie=Object(f.a)(W());function oe(){var e=Object(b.a)(["\n    subscription {\n        commentEdited {\n            content\n            id\n            imageUrl\n        }\n    }\n"]);return oe=function(){return e},e}function le(){var e=Object(b.a)(["\n    mutation editComment($commentId: String!, $content: String!) {\n        editComment(\n            commentId: $commentId\n            content: $content\n        ){\n            content\n            id\n        }\n    }\n"]);return le=function(){return e},e}function ue(){var e=Object(b.a)(["\n    subscription {\n        commentDeleted {\n            content\n            imageUrl\n            id\n        }\n    }\n"]);return ue=function(){return e},e}function se(){var e=Object(b.a)(["\n    mutation deleteComment($commentId: String!) {\n        deleteComment(commentId: $commentId)  {\n            content\n            id\n        }\n    }\n"]);return se=function(){return e},e}function me(){var e=Object(b.a)(["\n    subscription {\n        commentAdded {\n            comment {\n                user { \n                    username\n                    imageUrl\n                }\n                date\n                content\n                imageUrl\n                id\n            }\n            chatTitle\n        }\n    }\n"]);return me=function(){return e},e}function de(){var e=Object(b.a)(["\n    query comments($chatTitle: String){\n        comments(chatTitle: $chatTitle) {\n            content\n            date\n            user{\n                username\n                imageUrl\n            }\n            imageUrl\n            id\n        }\n    }\n"]);return de=function(){return e},e}function be(){var e=Object(b.a)(["\n    mutation createComment($chatTitle: String!, $content: String!, $imageUrl: String) {\n        createComment(chatTitle: $chatTitle, content: $content, imageUrl: $imageUrl)  {\n            content\n            date\n            imageUrl\n            user{\n                username\n                imageUrl\n            }\n        }\n    }\n"]);return be=function(){return e},e}var fe,ge=Object(f.a)(be()),Ee=Object(f.a)(de()),he=Object(f.a)(me()),pe=Object(f.a)(se()),Oe=Object(f.a)(ue()),je=Object(f.a)(le()),ve=Object(f.a)(oe()),we=function(e){var t=e.chat,n=e.isPinned,a=e.submitPin,r=e.submitUnpin,i=Object(U.b)(),o=Object(U.c)((function(e){return e.user})),l="No comments yet.",s={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},b=new Date(t.date).toLocaleTimeString([],s);t.latestComment&&(l=t.latestComment.content.length>30?"".concat(t.latestComment.content.substring(0,30),"... -").concat(t.latestComment.user.username):"".concat(t.latestComment.content," -").concat(t.latestComment.user.username),b=new Date(t.latestComment.date).toLocaleTimeString([],s));var f=Object(d.a)(ee,{onError:function(e){i(I({message:e.graphQLErrors[0].message,error:!0},10))}}),g=Object(u.a)(f,2),E=g[0];g[1];return c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",padding:"10px",marginBottom:"10px"}},c.a.createElement("div",null,c.a.createElement(q.b,{to:"/chats/".concat(t.title)},t.title)),c.a.createElement("div",null,l),c.a.createElement("div",null,b,n?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return r(t)}},"Unpin"):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return a(t)}},"Pin"),o.admin?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Delete chat?")&&E({variables:{chatId:t.id}})}},"Delete"):c.a.createElement(c.a.Fragment,null)))},ye=n(151),Ce=n(113),Se=function(){var e=Object(r.useState)(""),t=Object(u.a)(e,2),n=t[0],a=t[1],i=Object(U.b)(),o=Object(l.g)(),b=Object(d.a)(Z,{onError:function(e){i(I({message:e.graphQLErrors[0].message,error:!0},10))}}),f=Object(u.a)(b,2),g=f[0],E=f[1];return Object(r.useEffect)((function(){E.data&&(i(I({message:"New chat created",error:!1},10)),o.push("/chats/".concat(E.data.createChat.title)))}),[E.data]),c.a.createElement(c.a.Fragment,null,c.a.createElement(s.a,{onSubmit:function(e){e.preventDefault(),g({variables:{chatTitle:n}}),a("")}},c.a.createElement(ye.a,{size:"lg"},c.a.createElement(Ce.a,{md:"10",style:{paddingRight:"0"}},c.a.createElement(s.a.Control,{as:"textarea",rows:"1",style:{resize:"none"},id:"content",value:n,name:"content",onChange:function(e){var t=e.target;return a(t.value)},placeholder:"Title...",required:!0,block:"true"})),c.a.createElement(Ce.a,{md:"2",style:{paddingLeft:"0"}},c.a.createElement(m.a,{style:{height:"100%"},id:"submit",type:"submit",size:"lg",block:"true"},"Start new chat")))))},Ue=function(){var e=Object(U.b)(),t=Object(r.useState)([]),n=Object(u.a)(t,2),i=n[0],o=n[1],l=Object(J.a)(te),s=Object(u.a)(l,2),m=s[0],b=s[1],f=Object(J.a)(ne),g=Object(u.a)(f,2),E=g[0],h=g[1],p=Object(r.useState)([]),O=Object(u.a)(p,2),j=O[0],v=O[1],w=Object(r.useState)(""),y=Object(u.a)(w,2),C=y[0],S=y[1],k=Object(r.useState)(),T=Object(u.a)(k,2),$=T[0],F=T[1],D=Object(r.useCallback)((function(e,t){if(!$)return 0;if($.includes(e.title)&&!$.includes(t.title))return-1;if(!$.includes(e.title)&&$.includes(t.title))return 1;var n=e.date;e.latestComment&&(n=e.latestComment.date);var a=t.date;return t.latestComment&&(a=t.latestComment.date),a-n}),[$]);Object(r.useEffect)((function(){m(),E()}),[]),Object(r.useEffect)((function(){b.data&&(o(b.data.chats.slice(0).sort(D)),v(i))}),[b.data]),Object(r.useEffect)((function(){h.data&&F(h.data.pinnedChats.map((function(e){return e.title})))}),[h.data]),Object(_.a)(ae,{onSubscriptionData:function(e){var t=e.subscriptionData.data.chatAdded,n=i.concat(t);n.sort(D),o(n)}}),Object(_.a)(he,{onSubscriptionData:function(e){var t=e.subscriptionData,n=t.data.commentAdded.comment,r=t.data.commentAdded.chatTitle,c=i.map((function(e){return e.title===r?Object(a.a)({},e,{latestComment:n}):e}));c.sort(D),o(c)}}),Object(r.useEffect)((function(){v(""===C?i.slice(0).sort(D):i.filter((function(e){return e.title.toLowerCase().startsWith(C.toLowerCase())})).sort(D))}),[C,i,D]);var x=Object(d.a)(ce,{onError:function(t){e(I({message:t.graphQLErrors[0].message,error:!0},10))}}),L=Object(u.a)(x,2),N=L[0],P=L[1],z=Object(d.a)(ie,{onError:function(t){e(I({message:t.graphQLErrors[0].message,error:!0},10))}}),q=Object(u.a)(z,2),B=q[0],Q=q[1],A=function(e){window.confirm("Pin chat?")&&N({variables:{chatTitle:e.title}})};Object(r.useEffect)((function(){P.data&&(F($.concat(P.data.pinChat.title)),e(I({message:"Chat pinned",error:!1},10)))}),[P.data]);var R=function(e){window.confirm("Unpin chat?")&&B({variables:{chatTitle:e.title}})};Object(r.useEffect)((function(){Q.data&&(F($.filter((function(e){return e!==Q.data.unpinChat.title}))),e(I({message:"Chat unpinned",error:!1},10)))}),[Q.data]),Object(_.a)(re,{onSubscriptionData:function(e){var t=e.subscriptionData.data.chatDeleted;o(i.filter((function(e){return e.id!==t.id})))}});return c.a.createElement("div",null,c.a.createElement("h2",{style:{display:"inline-block",marginBottom:"0"}},"Chats"),c.a.createElement("input",{style:{float:"right",width:"30%",paddingBottom:"0",position:"relative",bottom:"-1.7vh"},type:"text",value:C,onChange:function(e){var t=e.target;return S(t.value)},placeholder:"Filter chats by title..."}),c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",borderColor:"grey",padding:"10px",marginBottom:"0",overflowY:"scroll",height:"77vh"}},j.map((function(e){return c.a.createElement(we,{key:e.id,chat:e,submitPin:A,submitUnpin:R,isPinned:$.includes(e.title)})}))),c.a.createElement(Se,null))},ke=n(152),Te=function(e){var t=e.comment,n=Object(U.b)(),a=Object(U.c)((function(e){return e.user})),i=Object(r.useState)(t.content),o=Object(u.a)(i,2),l=o[0],s=o[1],b=Object(r.useState)(!1),f=Object(u.a)(b,2),g=f[0],E=f[1],h=Object(d.a)(pe,{onError:function(e){n(I({message:e.graphQLErrors[0].message,error:!0},10))}}),p=Object(u.a)(h,2),O=p[0],j=p[1],v=Object(d.a)(je,{onError:function(e){n(I({message:e.graphQLErrors[0].message,error:!0},10))}}),w=Object(u.a)(v,2),y=w[0],C=w[1];Object(r.useEffect)((function(){j.data&&n(I({message:"Comment deleted",error:!1},10))}),[j.data]);var S=c.a.createElement(c.a.Fragment,null);t.imageUrl&&(S=c.a.createElement(c.a.Fragment,null,c.a.createElement(ke.a,{src:t.imageUrl,fluid:!0}),c.a.createElement("br",null)));var k=c.a.createElement(c.a.Fragment,null);t.user.imageUrl&&(k=c.a.createElement(c.a.Fragment,null,c.a.createElement(ke.a,{style:{height:"10%",width:"10%"},src:t.user.imageUrl,fluid:!0})));Object(r.useEffect)((function(){C.data&&(E(!1),n(I({message:"Comment edited",error:!1},10)))}),[C.data]);Object(r.useEffect)((function(){s(t.content)}),[t]);var T=new Date(t.date).toLocaleTimeString([],{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",padding:"10px",marginBottom:"10px"}},c.a.createElement("div",null,k," ",c.a.createElement(q.b,{to:"/users/".concat(t.user.username)},t.user.username)," ",T),c.a.createElement("textarea",{rows:"2",value:l,readOnly:!g,style:{width:"100%",resize:"none",border:"none"},onChange:function(e){var t=e.target;return s(t.value)},block:"true"}),S,a.username!==t.user.username&&!a.admin||"Comment deleted"===t.content?c.a.createElement(c.a.Fragment,null):c.a.createElement(c.a.Fragment,null,c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Delete comment?")&&O({variables:{commentId:t.id}})}},"Delete comment"),g?c.a.createElement(c.a.Fragment,null,c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){E(!1),s(t.content)}},"Stop editing"),c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Edit comment?")&&y({variables:{commentId:t.id,content:l}})}},"Submit edit")):c.a.createElement(c.a.Fragment,null,a.username===t.user.username?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){E(!0),t.content.endsWith(" -edited")&&s(t.content.substring(0,t.content.length-8))}},"Start editing"):c.a.createElement(c.a.Fragment,null))))},$e=function(e){var t=e.title,n=Object(r.useState)(""),a=Object(u.a)(n,2),i=a[0],o=a[1],l=Object(r.useState)(""),b=Object(u.a)(l,2),f=b[0],g=b[1],E=Object(U.b)(),h=Object(d.a)(ge,{onCompleted:function(){o(""),g("")},onError:function(e){E(I({message:e.graphQLErrors[0].message,error:!0},10))}}),p=Object(u.a)(h,2),O=p[0];p[1];return c.a.createElement("div",null,c.a.createElement(s.a,{onSubmit:function(e){e.preventDefault(),O({variables:{chatTitle:t,content:i,imageUrl:f}})}},c.a.createElement(ye.a,{size:"lg"},c.a.createElement(Ce.a,{md:"10",style:{paddingRight:"0"}},c.a.createElement(s.a.Control,{as:"textarea",rows:"2",style:{resize:"none"},id:"content",value:i,name:"content",onChange:function(e){var t=e.target;return o(t.value)},placeholder:"New comment...",required:!0,block:"true"}),c.a.createElement(s.a.Control,{size:"sm",type:"text",placeholder:"Image url...",value:f,name:"imageUrl",id:"imageUrl",onChange:function(e){var t=e.target;return g(t.value)},block:"true"})),c.a.createElement(Ce.a,{md:"2",style:{paddingLeft:"0"}},c.a.createElement(m.a,{style:{height:"100%"},id:"submit",type:"submit",size:"lg",block:!0},"Send")))))},Fe=function(e){var t=e.title,n=Object(r.useState)([]),i=Object(u.a)(n,2),o=i[0],s=i[1],m=Object(l.g)(),d=Object(r.useState)([]),b=Object(u.a)(d,2),f=b[0],g=b[1],E=Object(r.useState)(""),h=Object(u.a)(E,2),p=h[0],O=h[1],j=Object(J.a)(Ee),v=Object(u.a)(j,2),w=v[0],y=v[1],C=Object(r.useRef)(null);Object(r.useEffect)((function(){w({variables:{chatTitle:t}})}),[]),Object(r.useEffect)((function(){w({variables:{chatTitle:t}})}),[t]),Object(r.useEffect)((function(){y.data?s(y.data.comments.sort((function(e,t){return e.date-t.date}))):y.called&&!y.loading&&m.push("/error/Chat does not exist")}),[y]),Object(r.useEffect)((function(){C.current.scrollIntoView({behavior:"smooth"})}),[o,f]),Object(_.a)(he,{onSubscriptionData:function(e){var n=e.subscriptionData,a=n.data.commentAdded.comment;if(n.data.commentAdded.chatTitle===t){var r=o.concat(a);r.sort((function(e,t){return e.date-t.date})),s(r)}}}),Object(_.a)(Oe,{onSubscriptionData:function(e){var t=e.subscriptionData.data.commentDeleted;s(o.map((function(e){return e.id===t.id?Object(a.a)({},e,{content:t.content,imageUrl:t.imageUrl}):e})))}}),Object(_.a)(ve,{onSubscriptionData:function(e){var t=e.subscriptionData.data.commentEdited;s(o.map((function(e){return e.id===t.id?Object(a.a)({},e,{content:t.content}):e})))}}),Object(r.useEffect)((function(){g(""===p?o:o.filter((function(e){return e.content.toLowerCase().includes(p.toLowerCase())})))}),[p,o]);return c.a.createElement(c.a.Fragment,null,c.a.createElement("input",{style:{float:"right",width:"30%",paddingBottom:"0",position:"relative",bottom:"-1.7vh"},type:"text",value:p,onChange:function(e){var t=e.target;return O(t.value)},placeholder:"Filter comments by content..."}),c.a.createElement("br",null),c.a.createElement("div",{style:{borderStyle:"solid",borderRadius:"5px",borderColor:"grey",padding:"10px",marginBottom:"0",overflowY:"scroll",height:"70vh",width:"100%"}},0===o.length?c.a.createElement("div",null,"No comments yet"):f.map((function(e){return c.a.createElement(Te,{key:e.id,comment:e})})),c.a.createElement("div",{ref:C})),c.a.createElement($e,{title:t}))},Ie=function(){var e=Object(l.h)("/chats/:title"),t=e?e.params.title:null;return c.a.createElement("div",null,c.a.createElement("h2",{style:{display:"inline-block",marginBottom:"0"}},t),c.a.createElement(Fe,{title:t}))},De=function(){var e=Object(U.b)(),t=Object(l.g)(),n=Object(U.c)((function(e){return e.user})),i=Object(l.h)("/users/:username"),o=Object(r.useState)(null),s=Object(u.a)(o,2),b=s[0],f=s[1],g=Object(r.useState)(""),E=Object(u.a)(g,2),h=E[0],p=E[1],O=Object(r.useState)(!1),j=Object(u.a)(O,2),v=j[0],w=j[1],k=i?i.params.username:null,T=Object(J.a)(y),$=Object(u.a)(T,2),F=$[0],D=$[1],x=Object(r.useState)(c.a.createElement(c.a.Fragment,null)),L=Object(u.a)(x,2),N=L[0],P=L[1];Object(r.useEffect)((function(){F({variables:{username:k}})}),[k]),Object(r.useEffect)((function(){D.data?f(D.data.user):D.called&&!D.loading&&t.push("/error/User does not exist")}),[D]);var z=Object(d.a)(C,{onError:function(t){e(I({message:t.graphQLErrors[0].message,error:!0},10))}}),q=Object(u.a)(z,2),B=q[0],Q=q[1];Object(r.useEffect)((function(){Q.data&&(e(I({message:"Profile picture set",error:!1},10)),f(Object(a.a)({},b,{imageUrl:Q.data.setUserProfilePic.imageUrl})),p(""),w(!1),P(c.a.createElement(c.a.Fragment,null,c.a.createElement(ke.a,{style:{height:"10%",width:"10%"},src:Q.data.setUserProfilePic.imageUrl,fluid:!0}),c.a.createElement("br",null))))}),[Q.data]);var A=Object(d.a)(S,{onError:function(t){e(I({message:t.graphQLErrors[0].message,error:!0},10))}}),R=Object(u.a)(A,2),_=R[0],W=R[1];Object(r.useEffect)((function(){W.data&&(e(I({message:"Profile picture deleted",error:!1},10)),f(Object(a.a)({},b,{imageUrl:null})),p(""),w(!1),P(c.a.createElement(c.a.Fragment,null)))}),[W.data]);return Object(r.useEffect)((function(){b&&b.imageUrl&&P(c.a.createElement(c.a.Fragment,null,c.a.createElement(ke.a,{style:{height:"100%",width:"100%"},src:b.imageUrl,fluid:!0}),c.a.createElement("br",null)))}),[b]),c.a.createElement(c.a.Fragment,null,b?c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-3"},c.a.createElement("div",{className:"row"},c.a.createElement("div",null,N)),c.a.createElement("div",{className:"row"},c.a.createElement("h2",null,b.username)),c.a.createElement("div",{className:"row"},b.username===n.username?c.a.createElement(c.a.Fragment,null,v?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"row"},c.a.createElement("input",{type:"text",placeholder:"Url of the image...",value:h,onChange:function(e){var t=e.target;return p(t.value)}})),c.a.createElement("div",{className:"row"},c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){w(!1),p("")}},"Back"),b.imageUrl?c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Delete profile picture?")&&_()}},"Delete image"):c.a.createElement(c.a.Fragment,null),c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){window.confirm("Set profile picture?")&&B({variables:{imageUrl:h}})}},"Submit image"))):c.a.createElement(m.a,{type:"button",size:"sm",onClick:function(){return w(!0)}},"Set image")):c.a.createElement(c.a.Fragment,null))),c.a.createElement("div",{className:"col-9"},c.a.createElement("div",null,c.a.createElement("h2",{style:{display:"inline-block",marginBottom:"0"}},"".concat(k,"'s chat")),c.a.createElement(Fe,{title:"userChat".concat(k)})))):c.a.createElement(c.a.Fragment,null))},xe=function(){var e=Object(l.h)("/error/:errormessage"),t=e?e.params.errormessage:null;return c.a.createElement("h2",null,t)},Le=function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(R,null),c.a.createElement("div",{className:"container",style:{height:"100%"}},c.a.createElement(l.d,null,c.a.createElement(l.b,{path:"/error/:errormessage"},c.a.createElement(xe,null)),c.a.createElement(l.b,{path:"/chats/:title"},c.a.createElement(Ie,null)),c.a.createElement(l.b,{path:"/chats"},c.a.createElement(Ue,null)),c.a.createElement(l.b,{path:"/users/:username"},c.a.createElement(De,null)),c.a.createElement(l.b,{path:"/"},c.a.createElement(l.a,{to:"/chats"})))))},Ne=function(){var e=Object(r.useState)(""),t=Object(u.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)(""),o=Object(u.a)(i,2),b=o[0],f=o[1],g=Object(U.b)(),E=Object(l.g)(),h=Object(d.a)(w,{onError:function(e){g(I({message:e.graphQLErrors[0].message,error:!0},10))}}),p=Object(u.a)(h,2),O=p[0],j=p[1];Object(r.useEffect)((function(){if(j.data){var e=j.data.createUser.value,t=j.data.createUser.user;g(L(e)),localStorage.setItem("user-token",e),E.push("/"),localStorage.setItem("logged-user",JSON.stringify(t)),g(P(t)),g(I({message:"Signed in",error:!1},10))}}),[j.data]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(x,null),c.a.createElement("div",{className:"container"},c.a.createElement("h2",null,"Sign in"),c.a.createElement(s.a,{onSubmit:function(e){e.preventDefault(),O({variables:{username:n,password:b}}),a(""),f("")}},c.a.createElement(s.a.Label,null,"username:"),c.a.createElement(s.a.Control,{type:"text",id:"username",value:n,name:"username",onChange:function(e){var t=e.target;return a(t.value)},required:!0}),c.a.createElement(s.a.Label,null,"password:"),c.a.createElement(s.a.Control,{type:"password",id:"password",value:b,name:"password",onChange:function(e){var t=e.target;return f(t.value)},required:!0}),c.a.createElement(m.a,{id:"submit",type:"submit"},"sign in")," or ",c.a.createElement(q.b,{to:"/login"},"login"))))},Pe=function(){var e=Object(U.c)((function(e){return e.token}));return c.a.createElement("div",{style:{width:"100%",height:"100%",left:0,top:0,zIndex:10}},c.a.createElement(l.d,null,c.a.createElement(l.b,{path:"/signin"},e?c.a.createElement(l.a,{to:"/chats"}):c.a.createElement(Ne,null)),c.a.createElement(l.b,{path:"/login"},e?c.a.createElement(l.a,{to:"/chats"}):c.a.createElement(B,null)),c.a.createElement(l.b,{path:"/"},e?c.a.createElement(c.a.Fragment,null,c.a.createElement(Le,null)):c.a.createElement(l.a,{to:"/login"}))))},ze=n(58),qe=n(75),Be=n(76),Qe=n(77),Ae=n(105),Re=n(120),Je=n(117),_e=n(99),We=n(54),Ke=n(118),Ye=n(119),Me=Object(We.combineReducers)({notification:D,user:z,token:N}),Ve=Object(We.createStore)(Me,Object(Ke.composeWithDevTools)(Object(We.applyMiddleware)(Ye.a))),Ge=Object(Re.a)((function(e,t){var n=t.headers,r=localStorage.getItem("user-token");return{headers:Object(a.a)({},n,{authorization:r?"bearer ".concat(r):null})}})),He=new ze.a({uri:"/graphql"});fe=window.location.host.includes("localhost")?new _e.a({uri:"ws://".concat(window.location.host,"/graphql"),options:{reconnect:!0}}):new _e.a({uri:"wss://".concat(window.location.host,"/graphql"),options:{reconnect:!0}});var Xe=Object(qe.a)((function(e){var t=e.query,n=Object(Je.a)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),fe,Ge.concat(He)),Ze=new Be.a({cache:new Qe.a,link:Xe,defaultOptions:{watchQuery:{fetchPolicy:"no-cache"},query:{fetchPolicy:"no-cache"},mutation:{fetchPolicy:"no-cache"}}}),et=localStorage.getItem("user-token"),tt=localStorage.getItem("logged-user");et&&Ve.dispatch(L(et)),tt&&Ve.dispatch(P(JSON.parse(tt))),o.a.render(c.a.createElement(Ae.a,{client:Ze},c.a.createElement(U.a,{store:Ve},c.a.createElement(q.a,null,c.a.createElement(Pe,null)))),document.getElementById("root"))}},[[125,1,2]]]);
//# sourceMappingURL=main.a91de80f.chunk.js.map